(function(){var t,i=function(t,i){return function(){return t.apply(i,arguments)}},e=function(t,i){function e(){this.constructor=t}for(var n in i)s.call(i,n)&&(t[n]=i[n]);return e.prototype=i.prototype,t.prototype=new e,t.__super__=i.prototype,t},s={}.hasOwnProperty;window.MMG={Grid:{},Data:{},Utility:{},View:{},AJAX:{},Drawing:{},Filter:{},Templates:{},Lightbox:{},Lightboxes:{}},t=window.MMG,t.Utility.StyleDetector=function(){function t(){}return t.isStyleSupported=function(t,i){var e,s,n,a;return n=window.document.createElement("div"),s=/-([a-z]|[0-9])/gi,i=2===arguments.length?i:"inherit","CSS"in window&&"supports"in window.CSS?window.CSS.supports(t,i):"supportsCSS"in window?window.supportsCSS(t,i):(e=t.replace(s,function(t,i){return(i+"").toUpperCase()}),a=e in n.style,n.style.cssText=t+":"+i,a&&""!==n.style[e])},t}(),t.Data.Models={},t.Filter.CanvasFilters={grayscale:function(){var t;t=.2126*this.rgb.r+.7152*this.rgb.g+.0722*this.rgb.b,this.rgb.r=this.rgb.g=this.rgb.b=t},brightness:function(t){t=Math.floor(2.55*t),this.rgb.r+=t,this.rgb.g+=t,this.rgb.b+=t},sepia:function(){var t,i,e;e=.393*this.rgb.r+.769*this.rgb.g+.189*this.rgb.b,i=.349*this.rgb.r+.686*this.rgb.g+.168*this.rgb.b,t=.272*this.rgb.r+.534*this.rgb.g+.131*this.rgb.b,this.rgb.r=e,this.rgb.g=i,this.rgb.b=t},contrast:function(t){t=Math.pow((t+100)/100,2),this.rgb.r=255*((this.rgb.r/255-.5)*t+.5),this.rgb.g=255*((this.rgb.g/255-.5)*t+.5),this.rgb.b=255*((this.rgb.b/255-.5)*t+.5)},vibrance:function(t){var i,e,s;t*=-1,i=void 0,e=void 0,s=void 0,s=Math.max(this.rgb.r,this.rgb.g,this.rgb.b),e=(this.rgb.r+this.rgb.g+this.rgb.b)/3,i=2*Math.abs(s-e)/255*t/100,this.rgb.r!==s&&(this.rgb.r+=(s-this.rgb.r)*i),this.rgb.g!==s&&(this.rgb.g+=(s-this.rgb.g)*i),this.rgb.b!==s&&(this.rgb.b+=(s-this.rgb.b)*i)},saturate:function(t){var i;t*=-.01,i=void 0,i=Math.max(this.rgb.r,this.rgb.g,this.rgb.b),this.rgb.r!==i&&(this.rgb.r+=(i-this.rgb.r)*t),this.rgb.g!==i&&(this.rgb.g+=(i-this.rgb.g)*t),this.rgb.b!==i&&(this.rgb.b+=(i-this.rgb.b)*t)},colorize:function(t,i,e,s){this.rgb.r-=(this.rgb.r-t)*s/100,this.rgb.g-=(this.rgb.g-i)*s/100,this.rgb.b-=(this.rgb.b-e)*s/100},noise:function(t){var i,e;e=function(t,i,e){var s;return s=void 0,null===e&&(e=!1),s=t+Math.random()*(i-t),e?s.toFixed(e):Math.round(s)},t=2.55*Math.abs(t),i=e(t*-1,t),this.rgb.r+=i,this.rgb.g+=i,this.rgb.b+=i}},t.Utility.Queue=function(){function t(){this.size=i(this.size,this),this.put=i(this.put,this),this.take=i(this.take,this),this.stac=new Array}return t.prototype.take=function(){return this.stac.shift()},t.prototype.put=function(t){return this.stac.push(t),this.stac.length},t.prototype.size=function(){return this.stac.length},t}(),t.Filter.CanvasFilter=function(){function e(){}var s,n,a,o;return a={},o=t.Data.Models,n=t.Filter.CanvasFilters,e.getFilter=function(t){return null!=a[t]?a[t]:a[t]=new s(t)},s=function(){function t(t){this.gridId=t,this.applyFilter=i(this.applyFilter,this),this._loadFilters=i(this._loadFilters,this),this.model=o[this.gridId],this.meta=this.model.meta,this.rgb={},this.filtersList=this._loadFilters()}return t.prototype._loadFilters=function(){var t,i;for(t="",i=0;i<this.meta.filters.length;)t+="filters[this.meta.filters["+i+"][0]].apply(this, this.meta.filters["+i+"][1]);",i++;return new Function("filters",t)},t.prototype.applyFilter=function(t,i){var e,s,a;for(a=t.getImageData(0,0,i.width,i.height),e=a.data,s=0;s<e.length;)this.rgb.r=e[s],this.rgb.g=e[s+1],this.rgb.b=e[s+2],this.filtersList.call(this,n),e[s]=this.rgb.r,e[s+1]=this.rgb.g,e[s+2]=this.rgb.b,this.rgb={},s+=4;t.putImageData(a,0,0)},t}(),e}(),t.View.Template=function(){function e(){}var s,n,a;return n={},a=t.Data.Models,e.getTemplate=function(t,i,e){var a;return null==e&&(e="g"),a=""+t+i+e,null!=n[a]?n[a]:n[a]=new s(t,i,e)},s=function(){function e(t,e,s){this.gridId=t,this.name=e,this.type=s,this._compile=i(this._compile,this),this.getCompiled=i(this.getCompiled,this),this.model=a[this.gridId],this.meta=this.model.meta,this.compiled=null,this._setTemplate(),this._compile(),this._callCallback()}return e.prototype.getCompiled=function(){return this.compiled},e.prototype._compile=function(){this.compiled=_.template(this.template)},e.prototype._setTemplate=function(){switch(this.type){case"g":return this._setGTemplate();case"l":return this._setLTemplate()}},e.prototype._setGTemplate=function(){var i;this.template=t.Templates[this.name].template,this.callback=t.Templates[this.name].callback,this.meta.isMobile&&t.Templates[this.name].mobile&&(t.Templates[this.name].mobile.template&&(this.template=t.Templates[this.name].mobile.template),t.Templates[this.name].mobile.callback&&(this.callback=t.Templates[this.name].mobile.callback)),0<(i=this.meta.ieVer)&&i<=9&&t.Templates[this.name].ie9&&(t.Templates[this.name].ie9.template&&(this.template=t.Templates[this.name].ie9.template),t.Templates[this.name].ie9.callback&&(this.callback=t.Templates[this.name].ie9.callback)),8===this.meta.ieVer&&t.Templates[this.name].ie8&&(t.Templates[this.name].ie8.template&&(this.template=t.Templates[this.name].ie8.template),t.Templates[this.name].ie8.callback&&(this.callback=t.Templates[this.name].ie8.callback))},e.prototype._setLTemplate=function(){var i;if(this.template=t.Lightboxes[this.name].template,this.callback=t.Lightboxes[this.name].callback,this.meta.isMobile&&t.Lightboxes[this.name].mobile&&(t.Lightboxes[this.name].mobile.template&&(this.template=t.Lightboxes[this.name].mobile.template),t.Lightboxes[this.name].mobile.callback&&(this.callback=t.Lightboxes[this.name].mobile.callback)),0<(i=this.meta.ieVer)&&i<=9&&t.Lightboxes[this.name].ie9&&(t.Lightboxes[this.name].ie9.template&&(this.template=t.Lightboxes[this.name].ie9.template),t.Lightboxes[this.name].ie9.callback&&(this.callback=t.Lightboxes[this.name].ie9.callback)),8===this.meta.ieVer&&t.Lightboxes[this.name].ie8&&(t.Lightboxes[this.name].ie8.template&&(this.template=t.Lightboxes[this.name].ie8.template),t.Lightboxes[this.name].ie8.callback))return this.callback=t.Lightboxes[this.name].ie8.callback},e.prototype._callCallback=function(){if(this.callback&&_.isFunction(this.callback))return this.callback.call(this)},e}(),e}(),t.Utility.QueueSingleton=function(){function s(){}var n,a,o;return o={},a=t.Utility.Queue,s.getQueue=function(t){return null!=o[t]?o[t]:o[t]=new n},n=function(t){function s(){this._slow=i(this._slow,this),this._check=i(this._check,this),this.execute=i(this.execute,this),s.__super__.constructor.call(this)}return e(s,t),s.prototype.execute=function(t){return 0===this.size()?(this.put(t),this._slow()):this.put(t)},s.prototype._check=function(){var t;return t=this.take(),!!t&&(t[1].inView?t[0]:t=this._check())},s.prototype._slow=function(){return setTimeout(function(t){return function(){var i;if(i=t._check())return i(),t._slow()}}(this),50)},s}(a),s}(),t.Utility.QueueSimple=function(){function s(){}var n,a,o;return o={},a=t.Utility.Queue,s.getQueue=function(t){return null!=o[t]?o[t]:o[t]=new n},n=function(t){function s(){this._slow=i(this._slow,this),this.execute=i(this.execute,this),s.__super__.constructor.call(this)}return e(s,t),s.prototype.execute=function(t){return 0===this.size()?(this.put(t),this._slow()):this.put(t)},s.prototype._slow=function(){return setTimeout(function(t){return function(){var i;if(i=t.take())return i(),t._slow()}}(this),50)},s}(a),s}(),t.Drawing.DrawingSVG=function(){function e(t,e,n){this.gridId=t,this._cleanMemory=i(this._cleanMemory,this),this._drawImage=i(this._drawImage,this),this._initializeSVG=i(this._initializeSVG,this),this.model=s[this.gridId],this.meta=this.model.meta,this.retina=this.meta.retina,this.filters=this.meta.svgFiltersId,this.image=e,this.url=this.image.src,this.width=this.image.newWidth,this.height=this.image.newHeight,this.containerParent=n,this._initializeSVG()}var s;return s=t.Data.Models,e.prototype._initializeSVG=function(){var t,i;this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.containerWidth=Math.round(this.width),this.containerHeight=Math.round(this.height),this.svg.setAttribute("width",this.containerWidth),this.svg.setAttribute("height",this.containerHeight),this.svg.setAttribute("viewBox","0 0 "+this.containerWidth+" "+this.containerHeight),this.containerParent.appendChild(this.svg),this.svg.width=this.containerWidth,this.svg.style.width=this.containerWidth,this.svg.height=this.containerHeight,this.svg.style.height=this.containerHeight,this.svg.viewBox="0 0 "+this.svg.width+" "+this.svg.height,window.devicePixelRatio>1&&this.retina>0&&(i=this.svg.width,t=this.svg.height,this.svg.width=i*window.devicePixelRatio,this.svg.height=t*window.devicePixelRatio,this.svg.style.width=i,this.svg.style.height=t),this._drawImage()},e.prototype._drawImage=function(){var t;t=document.createElementNS("http://www.w3.org/2000/svg","image"),$(t).attr({width:this.containerWidth,height:this.containerHeight,filter:"url(#"+this.filters+")"}),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",this.url),this.svg.appendChild(t),this._cleanMemory()},e.prototype._cleanMemory=function(){this.retina=null,this.svg=null,this.filters=null,this.image=null,this.url=null,this.width=null,this.height=null,this.containerParent=null},e}(),t.Drawing.Drawing=function(){function e(t,e){this.gridId=t,this._cleanMemory=i(this._cleanMemory,this),this._getAffectedRectangle=i(this._getAffectedRectangle,this),this._drawImage=i(this._drawImage,this),this._initializeCanvas=i(this._initializeCanvas,this),this._loadImage=i(this._loadImage,this),this.model=n[this.gridId],this.meta=this.model.meta,this.data=this.model.data,this.retina=this.meta.retina,this.filters=this.meta.filters,this.twin=this.meta.twin,this.container=e,this.sourceURL=this.container.getAttribute("src"),this._loadImage(this.sourceURL,this._initializeCanvas)}var s,n;return n=t.Data.Models,s=t.Filter.CanvasFilter,e.prototype._loadImage=function(t,i){this.imageObject=this.container,"img"!==this.container.tagName.toLowerCase()&&(this.imageObject=document.createElement("img")),this.imageObject.onload=i.bind(this),"img"!==this.container.tagName.toLowerCase()&&(this.imageObject.src=t),this.imageObject.complete&&i()},e.prototype._initializeCanvas=function(){var t,i;this.imageObject.onload=null,this.rgb={},this.canvas=document.createElement("canvas"),this.containerParent=this.container.parentNode,this.containerWidth=this.container.offsetWidth,this.containerHeight=this.container.offsetHeight,this._insertAfter(this.container,this.canvas),this.context=this.canvas.getContext("2d"),this.canvas.width=this.containerWidth,this.canvas.style.width=this.container.style.width,this.canvas.height=this.containerHeight,this.canvas.style.height=this.container.style.height,this.canvas.style.top=this.container.style.top,this.canvas.style.left=this.container.style.left,this.canvas.style.maxWidth=this.container.style.maxWidth,this.canvas.style.maxHeight=this.container.style.maxHeight,window.devicePixelRatio>1&&this.retina>0&&(i=this.canvas.width,t=this.canvas.height,this.canvas.width=i*window.devicePixelRatio,this.canvas.height=t*window.devicePixelRatio,this.canvas.style.width=i,this.canvas.style.height=t,this.context.scale(window.devicePixelRatio,window.devicePixelRatio)),this._drawImage()},e.prototype._drawImage=function(){var t,i;t=this._getAffectedRectangle(this.imageObject),this.context.drawImage(this.imageObject,0,0,t.width,t.height),this.meta.filters&&(i=s.getFilter(this.gridId),i.applyFilter(this.context,this.canvas)),this._cleanMemory()},e.prototype._getAffectedRectangle=function(){var t;return t={},t.width=this.containerWidth,t.height=this.containerHeight,t},e.prototype._cleanMemory=function(){this.twin||(this.imageObject.src="",this.containerParent.removeChild(this.container),delete this.container,this.container!==this.imageObject&&delete this.imageObject,this.container=null,this.imageObject=null),delete this.context,this.canvas=null,this.context=null,this.containerParent=null,this.containerWidth=null,this.containerHeight=null,this.sourceURL=null,this.rgb=null,this.filters=null},e.prototype._insertAfter=function(t,i){t.parentNode.insertBefore(i,t.nextSibling)},e}(),t.Data.Rows={},t.View.Row=function(){function e(t){this.gridId=t,this._showImages=i(this._showImages,this),this._showImage=i(this._showImage,this),this._hideImages=i(this._hideImages,this),this._scroll=i(this._scroll,this),this._onScroll=i(this._onScroll,this),this._isInView=i(this._isInView,this),this._getClass=i(this._getClass,this),this.resize=i(this.resize,this),this.needNew=i(this.needNew,this),this.registerImage=i(this.registerImage,this),this._register=i(this._register,this),this.calculate=i(this.calculate,this),this._makeRow=i(this._makeRow,this),this.model=h[this.gridId],this.meta=this.model.meta,this.data=this.model.data,this.rowData={images:[],finished:!0,row:null},this.row=null,this.rows=r[this.gridId].data,this.rowMeta=r[this.gridId].meta,this.rowId=this.rows.length,this.images=[],this.width=0,this.height=this.meta.minHeight,this.queue=o.getQueue(this.gridId),this._makeRow(),this._register()}var s,n,a,o,h,r;return h=t.Data.Models,r=t.Data.Rows,a=t.View.Image,s=t.Drawing.Drawing,n=t.Drawing.DrawingSVG,o=t.Utility.QueueSingleton,e.prototype._makeRow=function(){var t;t="<div class='"+this.meta.NS+"-row'></div>",this.row=$(t),this.rowData.row=this.row},e.prototype.calculate=function(t){var i;return i=this.meta.minHeight*t.ratio,this.rowData.width=this.width+=i+this.meta.margin,t.newWidth=i,t.newHeight=this.meta.minHeight,!0},e.prototype._register=function(){this.rows[this.rowId]=this.rowData},e.prototype.registerImage=function(t){this.rowData.images.push(t)},e.prototype.needNew=function(){var t;return t=this.width-this.meta.margin,!(this.meta.root.width()-t>0)},e.prototype.resize=function(){var t,i,e,s,n,a,o,h;h=this,i=this.meta.margin,n=this.width-i,e=s=this.meta.minHeight,a=this.meta.root,t=this.rowData.images.length,n>a.width()?(s=(a.width()-i*(t-1))/(n-i*(t-1))*e,o=_.map(this.rowData.images,function(t){var i,e,n,a;return i=h.data[t],n=i.ratio,e=s*n,i.newWidth=e,i.newHeight=s,a=h._getClass(e),i.image.css({width:e,height:s}),null!=a&&i.image.addClass(a),$(h.meta.NSclass+"fs",i.image.get(0)).css({width:e,height:s}),i}),this.row.css({height:s+"px",width:a.width()+100+"px",display:"block","margin-bottom":i+"px"}),this.rowData.finished=!0):(_.each(this.rowData.images,function(t){var i;i=h.data[t],i.image.css({width:i.newWidth,height:s}),$(h.meta.NSclass+"fs",i.image.get(0)).css({width:i.newWidth,height:s})}),this.row.css({height:s+"px",width:a.width()+100+"px",display:"block","margin-bottom":i+"px"})),this.rowData.height=s,0===this.rowId?this.rowData.top=0:this.rowData.top=this.meta.margin+this.rows[this.rowId-1].top+s,this.rowMeta.scrollTop=$(document).scrollTop(),this.rowMeta.scrollLeft=$(document).scrollLeft(),this.rowData.inView=this._isInView(),this.rowData.inView||this._hideImages()},e.prototype._getClass=function(t){var i;switch(i=null,!1){case!(t<=this.meta.maxSmall):i=this.meta.NS+"-small";break;case!(t<=this.meta.maxMiddle):i=this.meta.NS+"-middle"}return i},e.prototype._isInView=function(){return e.isRowInView(this.rowData,this.meta,this.rowMeta)},e.isRowInView=function(t,i,e){var s,n,a;return 8===i.ieVer||(a=i.kVisible,n=t.top-e.scrollTop+i.root.offset().top,s=n+t.height,a=a||1,n<=i.winHeight*(a+1)&&s+i.winHeight*a>=0)},e.prototype._onScroll=function(){var t;t=_.throttle(this._scroll,100),$(document).on("scroll",t)},e.prototype._scroll=function(){this.rowMeta.scrollTop=$(document).scrollTop(),this.rowMeta.scrollLeft=$(document).scrollLeft(),this._isInView()?this.queue.execute(_.bind(this._showImages,this)):this._hideImages()},e.prototype._hideImages=function(){this.data[this.rowData.images[0]].image&&(_.each(this.rowData.images,function(t){return function(i){var e;return e=h[t.gridId].data[i].image,e.remove(),e=null,delete h[t.gridId].data[i].image,!1}}(this)),this.rowData.inView=!1)},e.prototype._showImage=function(t){var i,e,n,o,r,l,d;switch(n=new a(this.gridId,t),i=n.image.appendTo(this.row).css({"margin-right":this.meta.margin+"px",height:this.data[t].newHeight+"px",width:this.data[t].newWidth+"px"}),r=this._getClass(this.data[t].newWidth),null!=r&&i.addClass(r),$(this.meta.NSclass+"fs",i.get(0)).css({height:this.data[t].newHeight+"px",width:this.data[t].newWidth+"px"}),!1){case!this.meta.useCanvas:e=s.getDrawing(this.gridId),d=i.find(this.meta.NSclass+"icon"),o=d.parent().get(0),d.remove(),l=new Image,$(l).one("load",function(i){return function(){return e.setImage(i.data[t],l,o),l=null}}(this)),l.src=this.data[t].src}h[this.gridId].data[t].image=i},e.prototype._showImages=function(){this.rowData.inView||(_.each(this.rowData.images,function(t){return function(i){t._showImage(i)}}(this)),this.rowData.inView=!0)},e}(),t.View.Image=function(){function e(t,e){this.gridId=t,this.itemId=e,this._registerImage=i(this._registerImage,this),this._createImage=i(this._createImage,this),this._useTemplate=i(this._useTemplate,this),this.model=s[this.gridId],this.data=this.model.data[this.itemId],this.type=this.data.type,this.meta=this.model.meta,this._string="",this.image=null,this._useTemplate(),this._createImage(),this._registerImage()}var s,n;return s=t.Data.Models,n=t.View.Template,e.prototype._useTemplate=function(){var t,i;i=this.meta.templateName,this.type&&(i=this.type),t=n.getTemplate(this.gridId,i).getCompiled(),this._string=t({meta:this.meta,data:this.data,imageId:this.itemId})},e.prototype._createImage=function(){this.image=$(this._string)},e.prototype._registerImage=function(){this.data.image=this.image},e}(),t.Utility.Parser=function(){function e(){}var s,n,a;return a={},s=t.Data.Models,e.getParser=function(t){return null!=a[t]?a[t]:a[t]=new n(t)},n=function(){function t(t){this.gridId=t,this._applyParser=i(this._applyParser,this),this.ajax=i(this.ajax,this),this.parse=i(this.parse,this),this.model=s[this.gridId],this.meta=this.model.meta,this.data=this.model.data,this.NS=this.model.meta.NS,this.default="core",this.callback=this.model.meta.parser}return t.prototype.parse=function(){return _.isFunction(this.callback)?this._applyParser():console.log("the parser must be of function type!")},t.prototype.ajax=function(t){return _.isFunction(this.callback)?this._applyParser(t):console.log("the parser must be of function type!")},t.prototype._applyParser=function(t){return null==t&&(t=this.meta.root),this.callback.call(this,t)},t}(),e}(),t.Utility.ImageLoader=function(){function t(){}var i;return i=t,t.loadPics=function(){var t,e,s,n,a;return e=$.Deferred(),t=this.data,s=this.meta.loader,s.refresh(),s.loading=null!=t?t.length:void 0,s.rate=5,a=this,0===t.length?(s.rate=100,s.end=!0,e.resolve(),e):(n=_.map(t,function(e,n){var o,h,r;return r=e.src,o=new Image,h=$.Deferred(),$(o).one("load",function(){var i,e;e=t[n].width=$(this).naturalWidth(),i=t[n].height=$(this).naturalHeight(),t[n].ratio=e/i,s.loaded++,0!==s.loading&&(s.rate=5+Math.ceil(s.loaded/s.loading*95)),h.resolve()}),o.src=t[n].src=i._replaceForRetina.call(a,r),_.delay(function(){o.complete||(o.src="",h.resolve())},a.model.meta.maxWait),h}),$.when.apply(null,n).done(function(){s.end=!0,e.resolve()}),e)},t._replaceForRetina=function(t){var i,e,s;return e=this.model.meta,2!==e.retina||e.pixelRatio<1.5?t:t.indexOf(e.retinaSuffix+".")>=0?t:(i=t.match(e.regexMatch),s=e.retinaSuffix+i[0],t.replace(e.regexMatch,s))},t}(),t.View.View=function(){function e(t){this.gridId=t,this._getClass=i(this._getClass,this),this._showImage=i(this._showImage,this),this._showImages=i(this._showImages,this),this._hideImages=i(this._hideImages,this),this._scroll=i(this._scroll,this),this._resize=i(this._resize,this),this._setEvents=i(this._setEvents,this),this.add=i(this.add,this),this._buildView=i(this._buildView,this),this._setMinHeight=i(this._setMinHeight,this),this._appendImage=i(this._appendImage,this),this._setMeta=i(this._setMeta,this),this._registerRows=i(this._registerRows,this),this.model=l[this.gridId],this.data=this.model.data,this.meta=this.model.meta,this.queue=o.getQueue(this.gridId),this.queueSimple=h.getQueue(this.gridId),this._registerRows(),this._setMeta(),this._buildView(),this._setEvents()}var s,n,a,o,h,r,l,d;return l=t.Data.Models,a=t.View.Image,r=t.View.Row,d=t.Data.Rows,s=t.Drawing.Drawing,n=t.Drawing.DrawingSVG,o=t.Utility.QueueSingleton,h=t.Utility.QueueSimple,e.prototype._registerRows=function(){d[this.gridId]={data:[],meta:{},built:$.Deferred()},this.rowMeta=d[this.gridId].meta,this.rowData=d[this.gridId].data},e.prototype._setMeta=function(){var t;t={},t.scrollTop=$(document).scrollTop(),t.scrollLeft=$(document).scrollLeft(),d[this.gridId].meta=t},e.prototype._appendImage=function(t,i,e){var s;s=new a(this.gridId,i),s.image.appendTo(t.row).css({"margin-right":this.meta.margin+"px"}),t.registerImage(i),t.calculate(e)},e.prototype._needNewRow=function(t){return!t||t.needNew()},e.prototype._setMinHeight=function(t){this.meta.minHeight=_.min(_.pluck(t,"height")),(1===this.meta.retina||2===this.meta.retina&&this.meta.pixelRatio>1.5)&&(this.meta.minHeight=this.meta.minHeight/2),this.meta.rowHeight&&this.meta.rowHeight<this.meta.minHeight&&(this.meta.minHeight=this.meta.rowHeight)},e.prototype._buildView=function(t){var i,e,a,o,h,l;switch(e=$(document.createDocumentFragment()),a=!0,h=null,o=this.meta.root,null==t?(i=this.data,t=0):i=this.data.slice(t),this._setMinHeight(i),_.reduce(i,function(i,e,s,n){return this._needNewRow(h)&&(null!=h&&h.resize(),h=new r(this.gridId),h.row.appendTo(i)),this._appendImage(h,s+t,e),n.length===s+1&&(h.rowData.finished=!1,h.resize()),i},e,this),this.meta.root.trigger("dataLoaded",{all:this.data}),l=this,!1){case!this.meta.useCanvas:_.each(i,function(t,i){var e;t.image&&(e=t.image.find(l.meta.NSclass+"icon"),l.queueSimple.execute(_.bind(function(t,i){new s(t,i)},l,l.gridId,e.get(0))))});break;case!this.meta.SVGFilter:_.each(i,function(t,i){var e,s;t.image&&(s=t.image.find(l.meta.NSclass+"icon"),e=s.parent().get(0),l.meta.twin||s.remove(),l.queueSimple.execute(_.bind(function(t,i,e){new n(t,i,e)},l,l.gridId,t,e)))});break;case!this.meta.ieFilter:_.each(i,function(t,i){var e;t.image&&(l.meta.twin?(e=$("<img src='"+t.src+"' class='"+l.meta.NS+"-filtered'>"),$(l.meta.NSclass+"icon",t.image.get(0)).after(e),e.css({height:t.newHeight+"px",width:t.newWidth+"px"})):$(l.meta.NSclass+"icon",t.image.get(0)).addClass(l.meta.NS+"-filtered"))});break;case!this.meta.forcedTwin:_.each(i,function(t,i){var e;t.image&&(e=$("<img src='"+t.src+"' class='"+l.meta.NS+"-filtered'>"),$(l.meta.NSclass+"icon",t.image.get(0)).after(e),e.css({height:t.newHeight+"px",width:t.newWidth+"px"}))})}o.width(o.width()-1),o.append(e).css({visibility:"visible"}),o.width(o.width()+1),this.meta.root.trigger("afterLoad",{all:this.data}),this.meta.root.height("auto")},e.prototype.add=function(t){var i,e,s;i=_.last(d[this.gridId].data),s=this.data.length,0===this.data.length||i.finished||(s=i.images[0],e=this,i.row.remove(),d[this.gridId].data.pop()),l[this.gridId].data=this.data=this.data.concat(t),l[this.gridId].meta=this.meta,this._buildView(s)},e.prototype._setEvents=function(){$(window).resize(this._resize),this.meta.isMobile?$(document).on("scroll",this._scroll):$(document).on("scrollstop",this._scroll)},e.prototype._resize=function(){var t;t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,Math.abs(t-this.meta.winWidth)<12||(this.meta.root.empty(),this.meta.winWidth=t,this.meta.winHeight=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,this.meta.root.width("auto"),this._registerRows(),this._buildView())},e.prototype._scroll=function(){var t,i;this.meta.scrollStop||(i=$(document).scrollTop(),t=this.rowMeta.scrollTop-i,Math.abs(t)<this.meta.winHeight/this.meta.scrollDelta||(this.rowMeta.scrollTop=i,this.rowMeta.scrollLeft=$(document).scrollLeft(),this.meta.scrollStop=!0,_.each(this.rowData,function(t){return function(i,e){r.isRowInView(i,t.meta,t.rowMeta)?t._showImages(i):t._hideImages(i)}}(this)),this.meta.scrollStop=!1))},e.prototype._hideImages=function(t){t.inView&&(_.each(t.images,function(t){return function(i){var e;return e=l[t.gridId].data[i].image,null!=e&&e.remove(),e=null,delete l[t.gridId].data[i].image,!1}}(this)),t.inView=!1)},e.prototype._showImages=function(t){t.inView||(t.inView=!0,_.each(t.images,function(i){return function(e){i.queue.execute([_.bind(i._showImage,i,e,t),t])}}(this)))},e.prototype._showImage=function(t,i){var e,o,h,r,d,c,p;switch(h=new a(this.gridId,t),e=h.image.appendTo(i.row).css({"margin-right":this.meta.margin+"px",height:this.data[t].newHeight+"px",width:this.data[t].newWidth+"px"}),d=this._getClass(this.data[t].newWidth),null!=d&&e.addClass(d),$(this.meta.NSclass+"fs",e.get(0)).css({height:this.data[t].newHeight+"px",width:this.data[t].newWidth+"px"}),!1){case!this.meta.useCanvas:c=e.find(this.meta.NSclass+"icon"),new s(this.gridId,c.get(0));break;case!this.meta.SVGFilter:c=e.find(this.meta.NSclass+"icon"),r=c.parent().get(0),this.meta.twin||c.remove(),o=new n(this.gridId,this.data[t],r);break;case!this.meta.ieFilter:this.meta.twin?(p=$("<img src='"+this.data[t].src+"' class='"+this.meta.NS+"-filtered'>"),$(this.meta.NSclass+"icon",e.get(0)).after(p),p.css({height:this.data[t].newHeight+"px",width:this.data[t].newWidth+"px"})):$(this.meta.NSclass+"icon",e.get(0)).addClass(this.meta.NS+"-filtered");break;case!this.meta.forcedTwin:p=$("<img src='"+this.data[t].src+"' class='"+this.meta.NS+"-filtered'>"),$(this.meta.NSclass+"icon",e.get(0)).after(p),p.css({height:this.data[t].newHeight+"px",width:this.data[t].newWidth+"px"})}l[this.gridId].data[t].image=e},e.prototype._getClass=function(t){var i;switch(i=null,!1){case!(t<=this.meta.maxSmall):i=this.meta.NS+"-small";break;case!(t<=this.meta.maxMiddle):i=this.meta.NS+"-middle"}return i},e}(),t.Data.Core=function(){function e(t){this.gridId=t,this._html=i(this._html,this),this._data=i(this._data,this),this._ajax=i(this._ajax,this),this._loadPics=i(this._loadPics,this),this._init=i(this._init,this),this.data=[],this.model=n[this.gridId],this.meta=this.model.meta,this._init()}var s,n,a;return n=t.Data.Models,s=t.Utility.ImageLoader,a=t.Utility.Parser,e.prototype._init=function(){this._getData()},e.prototype._loadPics=function(){var t,i;i=this,t=s.loadPics.call(this),t.then(function(){n[i.gridId].meta=i.meta,i.data=_.reject(i.data,function(t){return null==t.height}),n[i.gridId].data=i.data,n[i.gridId].built.resolve()})},e.prototype._getData=function(){switch(!1){case!this.model.meta.data:this._data();break;case!this.model.meta.url:this._ajax();break;default:this._html()}},e.prototype._ajax=function(){var t;t=this,$.getJSON(this.model.meta.url,function(i){var e;if(t.meta.jsonParser){if(!_.isFunction(t.meta.jsonParser))return console.error("jsonParser must be a function"),void(t.data={});e=t.meta.jsonParser(i)}else e=i;e[0].src?t.data=e:(t.data=e[0],e[1]&&(t.meta.lastLoadedMeta=e[1])),t._loadPics()})},e.prototype._data=function(){this.data=this.model.meta.data,this._loadPics()},e.prototype._html=function(){var t;t=a.getParser(this.gridId),this.data=t.parse(),this._loadPics()},e}(),t.Grid.def={onInitCallback:function(){},afterInitCallback:function(){},onAjaxCallback:function(){},afterAjaxCallback:function(){},insertInImgBeforeCallback:function(){},insertInImgCallback:function(){},NS:"mmg",NSclass:".mmg-",NSevent:".mmg",regexMatch:/\.[\w\?=]+$/,retinaSuffix:"@2x",margin:2,retina:0,maxWait:5e3,maxSmall:180,maxMiddle:400,useCanvas:!1,pixelRatio:1,filters:null,SVGFilter:!1,kVisible:3,scrollDelta:1.1,stop:!1,scrollStop:!1,waitCount:0,isMobile:!1,rowWidth:0,elementsArray:[],top:0,supportSVGFilters:!0,rowsTop:[],onViewRowsLength:0,lightbox:{},oldIEFilter:"none"},t.Lightbox.setSwipe=function(i,e,s,n){var a,o,h,r,l;if(l=function(i,e,s){var n,a,o;return a=function(){var t,i,e,s,n,a,o;t=$(this.container),o=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,t.width(o).height(a).addClass("swipe-vertical"),s=t.children(".swipe-container"),n=s.children(".swipe"),i=s.children(".swipe-left-controlls"),e=s.children(".swipe-right-controlls"),n.width(o-e.width()-i.width()),n.height(a),e.height(a),i.height(a)},n={swipeTemplate:"<div class='swipe-container'><div class='swipe-indicator-container'></div><div class='swipe-left-controlls'><div class='swipe-title-container'><div class='swipe-title'></div></div></div><div class='swipe'><div class='swipe-wrap'></div></div><div class='swipe-right-controlls'><div class='swipe-ui hidden'><div class='swipe-close'><span class='swipe-icon-cross'></span></div><div class='swipe-buttons'><div class='swipe-left'><span class='swipe-icon-left'></span></div><div class='swipe-show swipe-play'><span></span></div><div class='swipe-right'><span class='swipe-icon-right'></span></div></div></div></div></div>",onMadeSwipe:a,parser:function(t){return _.map(t,function(t){var i;return{href:t.href,title:(null!=(i=t.lb)?i.title:void 0)||t.title}})},onResize:a,makeUI:function(){var t;t=this,$(this.container).find(".swipe-right").on("click",function(t){return function(i){return i.stopPropagation(),t.next()}}(this)),$(this.container).find(".swipe-left").on("click",function(t){return function(i){return i.stopPropagation(),t.prev()}}(this)),$(this.container).find(".swipe-play").on("click",function(t){return function(i){return i.stopPropagation(),t.toggle()}}(this)),$(this.container).find(".swipe-close").on("click",function(t){return function(i){return i.stopPropagation(),t.close()}}(this))},makeContent:function(){var t,i,e,s,n,a,o,h;if(n=this.data[this.index],t=$(this.container),s=document.createDocumentFragment(),n.title)for(h=n.title.split(""),a=0,o=h.length;a<o;a++)e=h[a],$("<div>"+e+"</div>").appendTo(s);i=t.find(".swipe-title-container").css({height:n.height,width:"100%",top:n.top,left:n.left}).removeClass("hidden").children(".swipe-title").empty().append(s),t.find(".swipe-ui").css({height:n.height,width:"100%",top:n.top,right:n.left}).removeClass("hidden")},onClose:function(){var t;t=$(this.container),t.find(".swipe-title-container").addClass("hidden"),t.find(".swipe-ui").addClass("hidden"),t.find(".swipe-indicator-container").css("visibility","hidden").empty()},beforeSlide:function(){$(this.container).find(".swipe-title-container, .swipe-ui").addClass("hidden")},marginH:0,marginV:3,indicator:!0,indicatorStart:function(){var t,i,e,s,n;e=$('<div class="swipe-indicator"><div></div></div>'),i=$(this.getCurrentSlide()).find(".swipe-center"),s=i[0].getBoundingClientRect(),t=$(this.container).find(".swipe-indicator-container").css({visibility:"visible",width:s.width,top:s.top,left:s.left}),e.appendTo(t).children("div").width($(window).width()).height(e.height()),n=this,setTimeout(function(){e.css({"animation-name":"indicator","-webkit-animation-name":"indicator","animation-duration":n.delay+"ms","-webkit-animation-duration":n.delay+"ms"})},0)},indicatorStop:function(){$(this.container).find(".swipe-indicator-container").css("visibility","hidden").empty()}},o=$.extend(n,s),new t.Lightbox.Swipe(i,e,o)},a=function(i,e,s){var n,a,o;return a=function(){var t,i,e,s,n,a,o;i=$(this.container),o=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,i.width(o).height(a).addClass("swipe-classica"),e=i.children(".swipe-container"),s=e.children(".swipe"),n=e.children(".swipe-top-controlls"),t=e.children(".swipe-bottom-controlls"),s.height(a-n.height()-t.height()),s.width(o)},n={swipeTemplate:"<div class='swipe-container'><div class='swipe-indicator-container'></div><div class='swipe-top-controlls'><div class='swipe-title-container'><div class='swipe-title'></div><div class='swipe-close'><span class='swipe-icon-cross'></span></div></div></div><div class='swipe'><div class='swipe-wrap'></div></div><div class='swipe-bottom-controlls'><div class='swipe-ui hidden'><div class='swipe-left'><span class='swipe-icon-left'></span></div><div class='swipe-show swipe-play'><span></span></div><div class='swipe-right'><span class='swipe-icon-right'></span></div><div class='swipe-counter'></div></div></div></div>",
onMadeSwipe:a,parser:function(t){return _.map(t,function(t){var i;return{href:t.href,title:(null!=(i=t.lb)?i.title:void 0)||t.title}})},onResize:a,makeUI:function(){var t;t=this,$(this.container).find(".swipe-right").on("click",function(t){return function(i){return i.stopPropagation(),t.next()}}(this)),$(this.container).find(".swipe-left").on("click",function(t){return function(i){return i.stopPropagation(),t.prev()}}(this)),$(this.container).find(".swipe-play").on("click",function(t){return function(i){return i.stopPropagation(),t.toggle()}}(this)),$(this.container).find(".swipe-close").on("click",function(t){return function(i){return i.stopPropagation(),t.close()}}(this))},makeContent:function(){var t,i,e;return t=$(this.container),i=t.find(".swipe-title-container"),e=this.data[this.index],i.width(e.width).removeClass("hidden").children(".swipe-title").html(e.title),t.find(".swipe-ui").width(e.width).removeClass("hidden"),t.find(".swipe-counter").html(this.index+1+" / "+this.length)},onClose:function(){var t;t=$(this.container),t.find(".swipe-title-container").addClass("hidden"),t.find(".swipe-ui").addClass("hidden"),t.find(".swipe-indicator-container").css("visibility","hidden").empty()},beforeSlide:function(){$(this.container).find(".swipe-title-container, .swipe-ui").addClass("hidden")},indicator:!0,indicatorStart:function(){var t,i,e,s,n;e=$('<div class="swipe-indicator"><div></div></div>'),i=$(this.getCurrentSlide()).find(".swipe-center"),s=i[0].getBoundingClientRect(),t=$(this.container).find(".swipe-indicator-container").css({visibility:"visible",width:s.width,top:s.top,left:s.left}),e.appendTo(t).children("div").width($(window).width()).height(e.height()),n=this,setTimeout(function(){e.css({"animation-name":"indicator","-webkit-animation-name":"indicator","animation-duration":n.delay+"ms","-webkit-animation-duration":n.delay+"ms"})},0)},indicatorStop:function(){$(this.container).find(".swipe-indicator-container").css("visibility","hidden").empty()}},o=$.extend(n,s),new t.Lightbox.Swipe(i,e,o)},r=function(i,e,s){var n,a,o;return a=function(){var t,i,e,s,n,a,o;i=$(this.container),o=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,i.width(o).height(a).addClass("swipe-classica"),e=i.children(".swipe-container"),s=e.children(".swipe"),n=e.children(".swipe-top-controlls"),t=e.children(".swipe-bottom-controlls"),s.height(a-n.height()-t.height()),s.width(o)},n={swipeTemplate:"<div class='swipe-container'><div class='swipe-indicator-container'></div><div class='swipe-top-controlls'><div class='swipe-title-container'><div class='swipe-close'><span class='swipe-icon-cross'></span></div></div></div><div class='swipe'><div class='swipe-wrap'></div></div><div class='swipe-bottom-controlls'><div class='swipe-ui hidden'><div class='swipe-left'><span class='swipe-icon-left'></span></div><div class='swipe-show swipe-play'><span></span></div><div class='swipe-right'><span class='swipe-icon-right'></span></div><div class='swipe-counter'></div></div></div></div>",onMadeSwipe:a,parser:function(t){return _.map(t,function(t){var i,e;return{href:t.href,title:(null!=(i=t.lb)?i.title:void 0)||t.title,description:(null!=(e=t.lb)?e.description:void 0)||t.description}})},onResize:a,makeUI:function(){var t;t=this,$(this.container).find(".swipe-right").on("click",function(t){return function(i){return i.stopPropagation(),t.next()}}(this)),$(this.container).find(".swipe-left").on("click",function(t){return function(i){return i.stopPropagation(),t.prev()}}(this)),$(this.container).find(".swipe-play").on("click",function(t){return function(i){return i.stopPropagation(),t.toggle()}}(this)),$(this.container).find(".swipe-close").on("click",function(t){return function(i){return i.stopPropagation(),t.close()}}(this))},makeContent:function(){var t,i,e;return t=$(this.container),i=t.find(".swipe-title-container"),e=this.data[this.index],i.width(e.width).removeClass("hidden"),t.find(".swipe-ui").width(e.width).removeClass("hidden"),t.find(".swipe-counter").html(this.index+1+" / "+this.length)},onClose:function(){var t;t=$(this.container),t.find(".swipe-title-container").addClass("hidden"),t.find(".swipe-ui").addClass("hidden"),t.find(".swipe-indicator-container").css("visibility","hidden").empty()},beforeSlide:function(){$(this.container).find(".swipe-title-container, .swipe-ui").addClass("hidden")},indicator:!0,indicatorStart:function(){var t,i,e,s,n;e=$('<div class="swipe-indicator"><div></div></div>'),i=$(this.getCurrentSlide()).find(".swipe-center"),s=i[0].getBoundingClientRect(),t=$(this.container).find(".swipe-indicator-container").css({visibility:"visible",width:s.width,top:s.top,left:s.left}),e.appendTo(t).children("div").width($(window).width()).height(e.height()),n=this,setTimeout(function(){e.css({"animation-name":"indicator","-webkit-animation-name":"indicator","animation-duration":n.delay+"ms","-webkit-animation-duration":n.delay+"ms"})},0)},indicatorStop:function(){$(this.container).find(".swipe-indicator-container").css("visibility","hidden").empty()}},o=$.extend(n,s),new t.Lightbox.Swipe(i,e,o)},o=function(i,e,s){var n,a,o;return a=function(){var t,i,e,s,n,a,o;i=$(this.container),o=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,i.width(o).height(a).addClass("swipe-classica"),e=i.children(".swipe-container"),s=e.children(".swipe"),n=e.children(".swipe-top-controlls"),t=e.children(".swipe-bottom-controlls"),s.height(a-n.height()-t.height()),s.width(o)},n={swipeTemplate:"<div class='swipe-container'><div class='swipe-top-controlls'><div class='swipe-title-container'><div class='swipe-title'></div></div></div><div class='swipe'><div class='swipe-wrap'></div></div><div class='swipe-bottom-controlls'><div class='swipe-ui hidden'><div class='swipe-counter'></div></div></div></div></div>",onMadeSwipe:a,parser:function(t){return _.map(t,function(t){var i;return{href:t.href,title:(null!=(i=t.lb)?i.title:void 0)||t.title}})},onResize:a,indicator:!1,onClose:function(){var t;t=$(this.container),t.find(".swipe-title-container").addClass("hidden"),t.find(".swipe-ui").addClass("hidden")},beforeSlide:function(){$(this.container).find(".swipe-title-container, .swipe-ui").addClass("hidden")},makeContent:function(){var t,i,e;t=$(this.container),i=t.find(".swipe-title-container"),e=this.data[this.index],i.width(e.width).removeClass("hidden").children(".swipe-title").html(e.title),t.find(".swipe-ui").width(e.width).removeClass("hidden"),t.find(".swipe-counter").html(this.index+1+" / "+this.length)}},o=$.extend(n,s),new t.Lightbox.Swipe(i,e,o)},h=function(i,e,s){var n,a,o;return a=function(){var t,i,e;t=$(this.container),e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,i=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,t.width(e).height(i).addClass("swipe-simple")},n={onMadeSwipe:a,parser:function(t){return _.map(t,function(t){var i;return{href:t.href,title:(null!=(i=t.lb)?i.title:void 0)||t.title}})},onResize:a,indicator:!1,marginH:3,marginV:3},o=$.extend(n,s),new t.Lightbox.Swipe(i,e,o)},_.isFunction(i))return i(e,s,n);switch(i){case"classica":return a(e,s,n);case"untitled":return r(e,s,n);case"minimal":return o(e,s,n);case"simple":return h(e,s,n);case"vertical":return l(e,s,n);default:return a(e,s,n)}},t.Lightbox.Swipe=function(){function t(t,e,s){this.container=t,null==s&&(s={}),this._showCaptions=i(this._showCaptions,this),this._hideAfter=i(this._hideAfter,this),this.getMargins=i(this.getMargins,this),this.getRect=i(this.getRect,this),this.toggle=i(this.toggle,this),this.stop=i(this.stop,this),this.play=i(this.play,this),this.next=i(this.next,this),this.prev=i(this.prev,this),this.last=i(this.last,this),this.first=i(this.first,this),this.go=i(this.go,this),this._onClick=i(this._onClick,this),this._onkeydown=i(this._onkeydown,this),this._next=i(this._next,this),this._prev=i(this._prev,this),this._resize=i(this._resize,this),this._setNaturalSize(),this.parser=s.parser||this._identity,this.data=this._parseData(e),this._init(s)}return t.prototype._noop=function(){},t.prototype._identity=function(t){return t},t.prototype._offloadFn=function(t){setTimeout(t||this._noop,0)},t.prototype._parseData=function(t){return this.parser(t)},t.prototype._init=function(t){if(!this.container)throw new Error("You must define a container element");this.browser={addEventListener:!!window.addEventListener,touch:"ontouchstart"in window,transitions:function(t){var i,e;e=["transitionProperty","WebkitTransition","MozTransition","OTransition","msTransition"];for(i in e)if(void 0!==t.style[e[i]])return!0;return!1}(document.createElement("swipe"))},this.index=parseInt(t.startSlide,10)||0,this.speed=t.speed||400,this.continuous=void 0===t.continuous||t.continuous,this.transitionEnd=t.transitionEnd,this.delay=0,this.indicator=t.indicator||!1,this.showDelay=t.delay||4e3,this.auto=t.auto,this.auto&&(this.delay=this.showDelay),this.stopPropagation=t.stopPropagation,this.disableScroll=t.disableScroll,this.closeOnEnd=t.closeOnEnd,this.enableClick=t.enableClick,null==this.enableClick&&(this.enableClick=!0),this.enableWheel=t.enableWheel,null==this.enableWheel&&(this.enableWheel=!0),this.swipeClass=t.swipeClass||"swipe",this.swipeWrapClass=t.swipeWrapClass||"swipe-wrap",this.slideClass=t.slideClass||"slide",this.playClass=t.playClass||"swipe-play",this.stopClass=t.stopClass||"swipe-stop",this.firstClass=t.firstClass||"swipe-first-slide",this.lastClass=t.lastClass||"swipe-last-slide",this.captionClass=t.captionClass||"mmg-lb-caption",this.lightbox=t.lightbox||{},this.ieVer=this.lightbox.ieVer,this.interval=null,this.makeUI=t.makeUI||this._noop,this.onResize=t.onResize,this.makeContent=t.makeContent,this.onMadeSwipe=t.onMadeSwipe,this.delayedSetup=t.delayedSetup,this.beforeSlide=t.beforeSlide,this.close=t.close||this._noop,this.close=_.wrap(this.close,function(t){return function(i){t.stop(),i()}}(this)),this.onClose=t.onClose||this._noop,this.indicatorStart=t.indicatorStart,this.indicatorStop=t.indicatorStop,this.loaderTemplate=t.loaderTemplate||'<div class="loader"><span class="l1"></span><span class="l2"></span><span class="l3"></span></div>',this.resizable=!0,void 0!==t.resizable&&(this.resizable=t.resizable),this.swipeTemplate=t.swipeTemplate,null==this.swipeTemplate&&(this.swipeTemplate="<div class='"+this.swipeClass+"'><div class='"+this.swipeWrapClass+"'></div></div>"),this.useCaptionTemplate=t.useCaptionTemplate,this.captionName=t.captionName,this.getCaptionName=t.getCaptionName,this.captionHideAfter=t.captionHideAfter,this.loadingClass=t.loadingClass||"loading",this.marginH=t.marginH||5,this.marginV=t.marginV||0,this.type="image",this.images=[],this._makeSwipe(),this.delayedSetup||this._setup(),this._makeUI(),this.enableClick&&$(this.container).on("click",this._onClick),this.enableWheel&&this._getWheel(this.container)},t.prototype._setup=function(){var t;this._removeAll(),this.auto&&(this.delay=this.showDelay),this.element=$(this.root).children("."+this.swipeWrapClass).get(0),this.slides=this._makeSlides(),this.length=this.slides.length,this.indicatorRun=!1,this.images=function(){var i,e,s,n;for(s=this.slides,n=[],i=0,e=s.length;i<e;i++)t=s[i],n.push(0);return n}.call(this),this.start={},this.delta={},this.isScrolling=void 0,this.length<2&&(this.continuous=!1),this.browser.transitions&&this.continuous&&this.length<3&&(this.element.appendChild(this.slides[0].cloneNode(!0)),this.element.appendChild(this.element.children[1].cloneNode(!0)),this.slides=this.element.children),this.slidePos=[],this.width=this.root.getBoundingClientRect().width||this.root.offsetWidth,this.element.style.width=this.length*this.width+"px",_.each(this.slides,function(t){return function(i,e){i.style.width=t.width+"px",i.setAttribute("data-index",e),t.browser.transitions&&(i.style.left=e*-t.width+"px",t._move(e,t.index>e?-t.width:t.index<e?t.width:0,0))}}(this)),this.continuous&&this.browser.transitions&&(this._move(this._circle(this.index-1),-this.width,0),this._move(this._circle(this.index+1),this.width,0)),this.browser.transitions||(this.element.style.left=this.index*-this.width+"px"),this.root.style.visibility="visible",this._loadImages(this.index),this._addListeners(),$("body").on("keydown",this._onkeydown)},t.prototype._resize=function(t){var i;null==t&&(t=!0),null!=(i=this.onResize)&&i.call(this),t&&this._setup()},t.prototype._onMadeSwipe=function(){var t;null!=(t=this.onMadeSwipe)&&t.call(this)},t.prototype._makeSwipe=function(){var t;t=$(this.swipeTemplate),t.appendTo($(this.container)),this._onMadeSwipe(),t.hasClass(this.swipeClass)?this.root=t.get(0):this.root=t.find("."+this.swipeClass).get(0)},t.prototype._makeContent=function(){var t;this._addClasses(),clearTimeout(this.hide),this._makeInterval(),null!=(t=this.makeContent)&&t.call(this),this._showCaptions()},t.prototype._makeUI=function(){this.makeUI.call(this)},t.prototype._removeAll=function(){$(this.root).off(),$(this.element).empty().off(),$("body").off("keydown",this._onkeydown)},t.prototype._makeSlides=function(){var t,i,e,s,n;for(s=this.data,n=[],i=0,e=s.length;i<e;i++)t=s[i],n.push(this._makeSlide(t));return n},t.prototype._makeSlide=function(t){return $('<div class="slide"></div>').appendTo($(this.element)).get(0)},t.prototype._isLegalIndex=function(t){var i,e;return e=this.length-1,i=t-this.index,-3<i&&i<3||!!this.continuous&&(e-i+1<3||e+i+1<3)},t.prototype._unloadImages=function(){var t,i,e;for(t=i=0,e=this.data.length-1;0<=e?i<=e:i>=e;t=0<=e?++i:--i)this._unloadImage(t)},t.prototype._unloadImage=function(t){this._isLegalIndex(t)||this.images[t]&&($(this.slides[t]).empty(),this.images[t]=!1)},t.prototype._loadSlide=function(t){var i;switch(i=this.data[t].type||this.type){case"image":this._loadImage(t)}},t.prototype._makeLoader=function(){return $(this.loaderTemplate)},t.prototype._loadingStart=function(t){$(this.slides[t]).addClass(this.loadingClass),this._makeLoader().appendTo(this.slides[t])},t.prototype._loadingStop=function(t){$(this.slides[t]).removeClass(this.loadingClass).empty()},t.prototype._loadError=function(t){console.log(event.currentTarget.src+" can't be loaded")},t.prototype._loadImage=function(t){var i,e,s,n,a,o,h,r,l,d;o=this,this._isLegalIndex(t)&&(this.images[t]>0||(this.images[t]=1,this._loadingStart(t),n=new Image,a=this.root,s=this.data,h=this.slides,r=$(a).height(),d=$(a).width(),e=d*(1-this.marginH/50),i=r*(1-this.marginV/50),l=e/i,$(n).on("error",function(i){o.images[t]=2,o._loadingStop(t),o._loadError(t)}),$(n).on("load",function(){var a,c,p,u,m,g,f,w;o.images[t]=3,w=$(this).naturalWidth(),c=$(this).naturalHeight(),u=c,m=w,g=w/c,g>l?w>e&&(m=e,u=m/g):c>i&&(u=i,m=u*g),u=Math.round(u),m=Math.round(m),o._loadingStop(t),p=Math.round((d-m)/2),f=Math.round((r-u)/2),a=o.useCaptionTemplate(o.data,o.captionName,t),$(n).wrap('<div class="swipe-center"></div>').parent().append(a).css({left:p,top:f,width:m,height:u}).appendTo(h[t]),s[t].width=m,s[t].height=u,s[t].top=f,s[t].left=p,t===o.index&&($(o.root).trigger("loadend"),o._makeContent())}),n.src=s[t].href))},t.prototype._loadImages=function(){var t,i,e;for(this._loadSlide(this.index),this.index+1<this.length&&this._loadSlide(this.index+1),this.index-1>=0&&this._loadSlide(this.index-1),t=i=e=this.data.length-1;e<=0?i<=0:i>=0;t=e<=0?++i:--i)this._loadSlide(t)},t.prototype._addListeners=function(){this.browser.addEventListener&&(this.browser.touch&&this.element.addEventListener("touchstart",this,!1),this.browser.transitions&&(this.element.addEventListener("webkitTransitionEnd",this,!1),this.element.addEventListener("msTransitionEnd",this,!1),this.element.addEventListener("oTransitionEnd",this,!1),this.element.addEventListener("otransitionend",this,!1),this.element.addEventListener("transitionend",this,!1),this.element.addEventListener("mousedown",this,!1),this.element.addEventListener("mousemove",this,!1),this.element.addEventListener("mouseup",this,!1),this.element.addEventListener("mouseout",this,!1)))},t.prototype._prev=function(){this.continuous?this._slide(this.index-1):this.index&&this._slide(this.index-1)},t.prototype._next=function(){var t;this.indicator&&this.indicatorRun&&null!=(t=this.indicatorStop)&&t.call(this),this.indicatorRun=!1,this.continuous?this._slide(this.index+1):this.index<this.length-1&&this._slide(this.index+1)},t.prototype._circle=function(t){return(this.length+t%this.length)%this.length},t.prototype._slide=function(t,i){var e,s,n;if(this.index!==t){if(this.browser.transitions){for(s=Math.abs(this.index-t)/(this.index-t),this.continuous&&(n=s,s=-this.slidePos[this._circle(t)]/this.width,s!==n&&(t=-s*this.length+t)),e=Math.abs(this.index-t)-1;e--;)this._move(this._circle((t>this.index?t:this.index)-e-1),this.width*s,0);t=this._circle(t),this._move(this.index,this.width*s,i||this.speed),this._move(t,0,i||this.speed),this.continuous&&this._move(this._circle(t-s),-(this.width*s),0)}else t=this._circle(t),this._animate(this.index*-this.width,t*-this.width,i||this.speed);this._changeIndex(t)}},t.prototype._move=function(t,i,e){this._translate(t,i,e),this.slidePos[t]=i},t.prototype._translate=function(t,i,e){var s,n;s=this.slides[t],n=null!=s?s.style:void 0,n&&(n.webkitTransitionDuration=n.MozTransitionDuration=n.msTransitionDuration=n.OTransitionDuration=n.transitionDuration=e+"ms",n.webkitTransform="translate("+i+"px,0)translateZ(0)",n.msTransform=n.MozTransform=n.OTransform="translateX("+i+"px)")},t.prototype._animate=function(t,i,e){var s,n;return e?(s=+new Date,void(n=setInterval(function(a){return function(){var o,h;return h=+new Date-s,h>e?(a.element.style.left=i+"px",a.delay&&a._begin(),null!=(o=a.transitionEnd)&&o.call(event,a.index,a.slides[a.index]),a._makeContent(),$(a.root).trigger("slidemoveend",{slide:a.slides[a.index],data:a.data[a.index],index:a.index}),a._loadImages(),a._unloadImages(),void clearInterval(n)):void(a.element.style.left=(i-t)*Math.floor(h/e*100)/100+t+"px")}}(this),4))):void(this.element.style.left=i+"px")},t.prototype.handleEvent=function(t){switch(t.type){case"mousedown":this._onmousedown(t);break;case"mousemove":this._onmousemove(t);break;case"mouseup":this._onmouseup(t);break;case"mouseout":this._onmouseout(t);break;case"touchstart":this._startHandler(t);break;case"touchmove":this._moveHandler(t);break;case"touchend":this._offloadFn(this._endHandler(t));break;case"webkitTransitionEnd":case"msTransitionEnd":case"oTransitionEnd":case"otransitionend":case"transitionend":this._offloadFn(this._transitionEndHandler(t))}this.stopPropagation&&t.stopPropagation()},t.prototype._onmousedown=function(t){t.preventDefault(),(t.originalEvent||t).touches=[{pageX:t.pageX,pageY:t.pageY}],this._startHandler(t)},t.prototype._onmousemove=function(t){this.start&&this.start.time&&((t.originalEvent||t).touches=[{pageX:t.pageX,pageY:t.pageY}],this._moveHandler(t))},t.prototype._onmouseup=function(t){this.start&&(this._endHandler(t),delete this.start)},t.prototype._onmouseout=function(t){var i,e;this.start&&(e=t.target,i=t.relatedTarget,i&&(i===e||$.contains(e,i))||this._onmouseup(t))},t.prototype._onkeydown=function(t){switch(t.which||t.keyCode){case 37:this.prev();break;case 39:this.next()}},t.prototype._startHandler=function(t){var i;i=t.touches[0],this.start={x:i.pageX,y:i.pageY,time:+new Date},this.isScrolling=void 0,this.delta={},this.element.addEventListener("touchmove",this,!1),this.element.addEventListener("touchend",this,!1)},t.prototype._moveHandler=function(t){var i;t.touches.length>1||t.scale&&1!==t.scale||(this.disableScroll&&t.preventDefault(),i=t.touches[0],this.delta={x:i.pageX-this.start.x,y:i.pageY-this.start.y},"undefined"==typeof isScrolling&&(this.isScrolling=!!(this.isScrolling||Math.abs(this.delta.x)<Math.abs(this.delta.y))),this.isScrolling||(t.preventDefault(),this.stop(),this.continuous?(this._translate(this._circle(this.index-1),this.delta.x+this.slidePos[this._circle(this.index-1)],0),this._translate(this.index,this.delta.x+this.slidePos[this.index],0),this._translate(this._circle(this.index+1),this.delta.x+this.slidePos[this._circle(this.index+1)],0)):(this.delta.x=this.delta.x/(!this.index&&this.delta.x>0||this.index===this.length-1&&this.delta.x<0?Math.abs(this.delta.x)/this.width+1:1),this._translate(this.index-1,this.delta.x+this.slidePos[this.index-1],0),this._translate(this.index,this.delta.x+this.slidePos[this.index],0),this._translate(this.index+1,this.delta.x+this.slidePos[this.index+1],0))))},t.prototype._changeIndex=function(t){var i;this.index=t,null!=(i=this.beforeSlide)&&i.call(this)},t.prototype._endHandler=function(t){var i,e,s,n;e=+new Date-this.start.time,n=Number(e)<250&&Math.abs(this.delta.x)>20||Math.abs(this.delta.x)>this.width/2,s=!this.index&&this.delta.x>0||this.index===this.slides.length-1&&this.delta.x<0,this.continuous&&(s=!1),i=this.delta.x<0,this.isScrolling||(n&&!s?i?(this.continuous?(this._move(this._circle(this.index-1),-this.width,0),this._move(this._circle(this.index+2),this.width,0)):this._move(this.index-1,-this.width,0),this._move(this.index,this.slidePos[this.index]-this.width,this.speed),this._move(this._circle(this.index+1),this.slidePos[this._circle(this.index+1)]-this.width,this.speed),this._changeIndex(this._circle(this.index+1))):(this.continuous?(this._move(this._circle(this.index+1),this.width,0),this._move(this._circle(this.index-2),-this.width,0)):this._move(this.index+1,this.width,0),this._move(this.index,this.slidePos[this.index]+this.width,this.speed),this._move(this._circle(this.index-1),this.slidePos[this._circle(this.index-1)]+this.width,this.speed),this._changeIndex(this._circle(this.index-1))):this.continuous?(this._move(this._circle(this.index-1),-this.width,this.speed),this._move(this.index,0,this.speed),this._move(this._circle(this.index+1),this.width,this.speed)):(this._move(this.index-1,-this.width,this.speed),this._move(this.index,0,this.speed),this._move(this.index+1,this.width,this.speed))),this.element.removeEventListener("touchmove",this,!1),this.element.removeEventListener("touchend",this,!1)},t.prototype._transitionEndHandler=function(t){var i;parseInt(t.target.getAttribute("data-index"),10)===this.index&&(this.delay&&this._begin(),null!=(i=this.transitionEnd)&&i.call(t,this.index,this.slides[this.index]),this._makeContent(),$(this.root).trigger("slidemoveend",{slide:this.slides[this.index],data:this.data[this.index],index:this.index}),this._loadImages(),this._unloadImages())},t.prototype._onClick=function(t){return this.delta&&(Math.abs(this.delta.x)>20||Math.abs(this.delta.y)>20)?void delete this.delta:void($(t.target).is("img")||$(t.target).hasClass(this.captionClass)?this.next():this.close())},t.prototype._begin=function(){var t,i;!this.continuous&&this.isLast()?this.closeOnEnd?(this.interval=setTimeout(this.close,this.delay),null!=(t=this.indicatorStart)&&t.call(this),this.indicatorStart&&(this.indicatorRun=!0)):this.stop():(this.interval=setTimeout(this._next,this.delay),this.indicator&&(null!=(i=this.indicatorStart)&&i.call(this),this.indicatorStart&&(this.indicatorRun=!0)))},t.prototype._stop=function(){this.delay=0,clearTimeout(this.interval)},t.prototype._setNaturalSize=function(){!function(t){var i,e,s;e=["Width","Height"],i=void 0,s=function(i,e){t.fn[i]=i in new Image?function(){return this[0][i]}:function(){var t,i,s;return i=this[0],t=void 0,s=void 0,"img"===i.tagName.toLowerCase()&&(t=new Image,t.src=i.src,s=t[e]),s}};for(;i=e.pop();)s("natural"+i,i.toLowerCase())}(jQuery)},t.prototype.setup=function(){this._setup()},t.prototype.go=function(t,i){this.stop(),this._slide(t,i)},t.prototype.first=function(){this.stop(),this._slide(0,this.speed/2)},t.prototype.last=function(){this.stop(),this._slide(this.length-1,this.speed/2)},t.prototype.prev=function(){this.stop(),this._prev()},t.prototype.next=function(){this.stop(),this._next()},t.prototype.getPos=function(){return this.index},t.prototype.getRoot=function(){return this.root},t.prototype.getNumSlides=function(){return this.length},t.prototype.getStatus=function(){return this.images[this.index]},t.prototype.getCurrentSlide=function(){return this.slides[this.index]},t.prototype.getCurrentTitle=function(){return this.data[this.index].title},t.prototype.getCurrentType=function(){return this.data[this.index].type},t.prototype.play=function(){var t;this.delay=this.showDelay,this._begin(),t=$(this.container).find("."+this.playClass),t&&t.removeClass(this.playClass).addClass(this.stopClass)},t.prototype.stop=function(){var t,i;this._stop(),this.indicator&&this.indicatorRun&&null!=(i=this.indicatorStop)&&i.call(this),this.indicatorRun=!1,t=$(this.container).find("."+this.stopClass),t&&t.removeClass(this.stopClass).addClass(this.playClass)},t.prototype.toggle=function(){this.delay?this.stop():this.play()},t.prototype.getRect=function(){return this.root.getBoundingClientRect()},t.prototype.getMargins=function(){return{V:this.marginV,H:this.marginH}},t.prototype.setData=function(t){this.data=this._parseData(t)},t.prototype.setIndex=function(t){this.index=1*t},t.prototype.resize=function(t){this._resize(t)},t.prototype._getWheel=function(t){var i,e;i=function(t){return function(i){var e;i=i||window.event,e=i.deltaY||i.detail||-i.wheelDelta,e>0?t.element.children&&t.next():e<0&&t.element.children&&t.prev(),i.preventDefault?i.preventDefault():i.returnValue=!1}}(this),e=_.throttle(i,200),t.addEventListener?"onwheel"in document?t.addEventListener("wheel",e,!1):"onmousewheel"in document?t.addEventListener("mousewheel",e,!1):t.addEventListener("MozMousePixelScroll",e,!1):t.attachEvent("onmousewheel",e)},t.prototype.isLast=function(){return!this.continuous&&this.index===this.length-1},t.prototype.isFirst=function(){return!this.continuous&&0===this.index},t.prototype._addClasses=function(){var t;this.continuous||(t=$(this.container),this.isLast()?t.addClass(this.lastClass).removeClass(this.firstClass):this.isFirst()?t.removeClass(this.lastClass).addClass(this.firstClass):t.removeClass(this.lastClass).removeClass(this.firstClass))},t.prototype._makeInterval=function(){this.captionHideAfter&&(this.hide=setTimeout(this._hideAfter,this.captionHideAfter))},t.prototype._hideAfter=function(){var t,i,e;t=$(this.slides[this.index]).find(".mmg-lb-caption"),0<(i=this.ieVer)&&i<10||t.removeClass("mmg-lb-show"),null!=(e=this.lightbox.root)&&e.trigger("timeForCaptionHide",t.get(0))},t.prototype._showCaptions=function(){var t,i,e,s;i=$(this.container),t=$(this.slides[this.index]).find(".mmg-lb-caption"),0<(e=this.ieVer)&&e<10||(i.find(".mmg-lb-show").removeClass("mmg-lb-show"),setTimeout(function(){return t.addClass("mmg-lb-show")},0)),null!=(s=this.lightbox.root)&&s.trigger("timeForCaption",t.get(0))},t}(),t.Lightbox.LightboxSwipe=function(){function e(t,e){this.gridId=t,this.meta=e,this.close=i(this.close,this),this._makeLightBox=i(this._makeLightBox,this),this._show_ie9=i(this._show_ie9,this),this._show=i(this._show,this),this._onResize=i(this._onResize,this),this._hide=i(this._hide,this),this._setVendorPrefix=i(this._setVendorPrefix,this),this._removeStylesheet=i(this._removeStylesheet,this),this._setStylesheet=i(this._setStylesheet,this),this._replaceForRetina=i(this._replaceForRetina,this),this._setAnimationName=i(this._setAnimationName,this),this.show=i(this.show,this),this.vendorPrefix="-webkit-",this.isRetina=!1,this.pixelRatio=1,this.regexMatch=/\.[\w\?=]+$/,this.retinaSuffix="@2x",this.count=0,this.NS="mmg",this.options=this.meta.lightbox,this.isActive=!1,this.current_index=0,this._init()}var s;return s=t.View.Template,e.prototype._init=function(){var t,i;i="options parameter must be of an Object type!",void 0===this.options?alert(i):"string"==typeof this.options?t=this.options:"object"==typeof this.options?(t=this.options.grid,this.options.retinaSuffix&&(this.retinaSuffix=this.options.retinaSuffix),this.pixelRatio=window.devicePixelRatio,this.options.retina&&(this.isRetina=this.options.retina),this.options.ns&&(this.NS=options.ns+"-"),this.NSclass="."+this.NS+"-",this.options.name&&(this.name=this.options.name),this.captionHideAfter=this.options.captionHideAfter,this.options.swipe&&(this.isSwipe=!0,_.isObject(this.options.swipe)?this.swipeOptions=this.options.swipe:this.swipeOptions={},this.swipeName=this.swipeOptions.name||"classica")):alert(i),this.root=$(t),this.ieVer=this._ieVer(),this.loaderTemplate=$("<div id='"+this.NS+"-viewer-loader'><span class='l1'></span><span class='l2'></span><span class='l3'></span></div>"),this._makeLightBox(),this.bodyhtml=$("html, body"),this.body=$("body"),this.html=$("html"),this.bodyOverflowX=this.body.css("overflow-x"),this.bodyOverflowY=this.body.css("overflow-y"),this.htmlOverflowX=this.html.css("overflow-x"),this.htmlOverflowY=this.html.css("overflow-y"),$(window).resize(this._onResize),this._setWin()},e.prototype._setWin=function(){var t,i;i=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,t=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,this.container.css({width:i,height:t})},e.prototype.setData=function(t){this.data=t,this.isSwipe&&this.swipe&&this.swipe.setData(t)},e.prototype.show=function(t){this._setWin(),this.ieVer>0&&this.ieVer<10?this._show_ie9(t):this._show(t)},e.prototype._setAnimationName=function(){return this.count++,this.NS+"-lightbox-"+this.gridId+"-"+this.count},e.prototype._replaceForRetina=function(t){var i,e;return this.isRetina&&1!==this.pixelRatio?t.indexOf(this.retinaSuffix)>=0?t:(i=t.match(this.regexMatch),e=this.retinaSuffix+i[0],t.replace(this.regexMatch,e)):t},e.prototype._setStylesheet=function(t,i){$("<style>",{class:this.NS+"-"+i,type:"text/css"}).text(t).appendTo("head")},e.prototype._removeStylesheet=function(t){var i;i=this.NS+"-"+t,$("head>style."+i).remove()},e.prototype._setVendorPrefix=function(){"animation"in this.container.get(0).style&&(this.vendorPrefix="")},e.prototype._hide=function(){var t,i;this.isActive&&(this.isActive=!1,i=this,null!=(t=this.loader)&&t.remove(),this.bg.removeClass("mmg-on"),setTimeout(function(){i.container.css({visibility:"hidden",display:"none"})},400),this.imageBlock.empty().removeAttr("style").removeClass(this.NS+"-animate"),this.image=null,this.imageBlock.off(),this._removeStylesheet("lightbox-animation"),this.swipe._removeAll(),this.body.css({"overflow-x":this.bodyOverflowX,"overflow-y":this.bodyOverflowY}),this.html.css({"overflow-x":this.htmlOverflowX,"overflow-y":this.htmlOverflowY}))},e.prototype._onResize=function(){var t;this._setWin(),null!=(t=this.swipe)&&t.resize(this.isActive)},e.prototype._show=function(t){var i,e,s,n,a,o,h,r,l,d,c,p,u,m,g,f;this.isActive=!0,p=this,this.bodyhtml.css({"overflow-x":"hidden","overflow-y":"hidden"}),d=function(i){p.swipe.setIndex(t),p.swipe.setup(),$(p.swipe.getRoot()).one("loadend",function(){p.imageBlock.empty().removeAttr("style").css({visibility:"hidden"}).removeClass(p.NS+"-animate"),p.swipe.delay&&p.swipe.play()}),$(this).off("oanimationend MSAnimationEnd webkitAnimationEnd animationend")},this.container.css({display:"block",visibility:"visible"}),setTimeout(function(){return p.bg.addClass("mmg-on")},50),f=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,g=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,h=this.data[t].href,h=this._replaceForRetina(h),this.current_index=t,this.image=this.data[t].image,c=this.swipe.getRect(),l=this.swipe.getMargins(),a=this.image.get(0).getBoundingClientRect(),u=a.top,r=a.left,m=a.right-r,o=a.bottom-u,n=c.width*(1-l.H/50),i=c.height*(1-l.V/50),s=c.top,e=c.left,this.loader=this.loaderTemplate.clone().css({top:o/2-8,left:m/2-40}),this.imageBlock.css({width:m,height:o,top:u,left:r}).append(this.loader),$("<img>").appendTo(this.imageBlock).one("load",function(){var t,a,h,g,f,w,v,_,b,y,x,S,C;p.loader.remove(),$(this).addClass(p.NS+"-visible"),
x=this.naturalWidth,y=this.naturalHeight,_=x/y,C=n/i,w=y,v=x,_>C?x>n&&(v=n,null==e&&(e=c.width*l.H/100),w=v/_):y>i&&(w=i,null==s&&(s=c.height*l.V/100),v=w*_),w=Math.round(w),v=Math.round(v),s=Math.round(s),e=Math.round(e),h=(m-v)/2,g=(o-w)/2,t=(m-v)/2+c.width/2-(r+m/2)+e,a=(o-w)/2+c.height/2-(u+o/2)+s,b="scale3d("+m/v+", "+o/w+", 1)",h=Math.round(h),g=Math.round(g),t=Math.round(t),a=Math.round(a),p.imageBlock.css({width:v,height:w,"-webkit-transform":"translate3d("+h+"px,"+g+"px, 0) "+b,transform:"translate3d("+h+"px,"+g+"px, 0) "+b}),f=p._setAnimationName(),S="@"+p.vendorPrefix+"keyframes "+f+" {0% {"+p.vendorPrefix+"transform: translate3d("+h+"px,"+g+"px, 0) "+b+"} 40% {"+p.vendorPrefix+"transform: translate3d("+t+"px,"+a+"px, 0) "+b+" }100% {"+p.vendorPrefix+"transform: translate3d("+t+"px,"+a+"px, 0) scale3d(1,1,1)}}",p._setStylesheet(S,"lightbox-animation"),p.imageBlock.css(p.vendorPrefix+"animation-name",f).addClass(p.NS+"-animate").one("oanimationend MSAnimationEnd webkitAnimationEnd animationend",d),$(this).off("load")}).attr("src",h)},e.prototype._show_ie9=function(t){this.isActive=!0,this.container.css({display:"block",visibility:"visible"}),this.bg.stop(!0).css({opacity:0}).animate({opacity:.9},1e3),this.swipe.setIndex(t),this.swipe.setup(),$(this.swipe.getRoot()).one("loadend",function(t){return function(){t.swipe.delay&&t.swipe.play()}}(this))},e.prototype._makeLightBox=function(){var i,e,s,n;this.container=$("<div></div>",{class:this.NS+"-lb",id:this.NS+"-lb-"+this.gridId.substr(6)}).css({display:"none"}).appendTo("body"),this.imageBlock=$("<div></div>",{class:this.NS+"-center"}).appendTo(this.container),this.swipeContainer=$("<div></div>",{class:this.NS+"-swipe-container"}).appendTo(this.container),this.bg=$("<div></div>",{class:this.NS+"-lb-bg"}).appendTo(this.container),this.container.on("click touchend escape.mmg",function(t){return function(i){t.isSwipe&&"escape"!==i.type||t.swipe.close()}}(this)),e=this,$(document).on("keydown",function(t){27===t.which&&e.container.trigger("escape.mmg")}),this._setVendorPrefix(),9===this.ieVer&&this.container.addClass(this.NS+"-ie9"),8===this.ieVer&&this.container.addClass(this.NS+"-ie8"),i=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i,i.test(navigator.userAgent)&&this.container.addClass(this.NS+"-lb-mb"),n={delayedSetup:!0,resizable:!1,close:this.close,captionName:this.name,lightbox:this.meta,captionHideAfter:this.captionHideAfter,useCaptionTemplate:_.partial(this.useCaptionTemplate,this.meta,this.gridId)},s=_.extend(this.swipeOptions,n),this.swipe=t.Lightbox.setSwipe(this.swipeName,this.swipeContainer.get(0),this.data,s)},e.prototype._ieVer=function(){var t;switch(t=0,!1){case!(document.all&&!document.querySelector):t=7;break;case!(document.all&&!document.addEventListener):t=8;break;case!(document.all&&!window.atob):t=9;break;case!document.all:t=10}return t},e.prototype.close=function(){var t;null!=(t=this.swipe)&&t.onClose(),this._hide()},e.prototype.useCaptionTemplate=function(i,e,s,n,a){var o;return!!n&&(o=t.View.Template.getTemplate(e,n,"l").getCompiled())({meta:i,data:s[a]})},e}(),t.Lightbox.Lightbox=function(){function e(t,e){this.gridId=t,this.meta=e,this.close=i(this.close,this),this._makeLightBox=i(this._makeLightBox,this),this._show_ie9=i(this._show_ie9,this),this._show=i(this._show,this),this._onResize=i(this._onResize,this),this._hide=i(this._hide,this),this._setVendorPrefix=i(this._setVendorPrefix,this),this._removeStylesheet=i(this._removeStylesheet,this),this._setStylesheet=i(this._setStylesheet,this),this._replaceForRetina=i(this._replaceForRetina,this),this._setAnimationName=i(this._setAnimationName,this),this.show=i(this.show,this),this.vendorPrefix="-webkit-",this.isRetina=!1,this.isSimpleClick=!0,this.pixelRatio=1,this.regexMatch=/\.[\w\?=]+$/,this.retinaSuffix="@2x",this.count=0,this.NS="mmg",this.options=this.meta.lightbox,this.isActive=!1,this.current_index=0,this._init()}var s;return s=t.View.Template,e.prototype._init=function(){var t,i;i="options parameter must be of an Object type!",void 0===this.options?alert(i):"string"==typeof this.options?t=this.options:"object"==typeof this.options?(t=this.options.grid,this.options.retinaSuffix&&(this.retinaSuffix=this.options.retinaSuffix),this.pixelRatio=window.devicePixelRatio,this.options.retina&&(this.isRetina=this.options.retina),this.options.ns&&(this.NS=options.ns+"-"),this.NSclass="."+this.NS+"-",this.options.simpleClick===!1&&(this.isSimpleClick=this.options.simpleClick),this.options.captionHideAfter&&(this.captionHideAfter=this.options.captionHideAfter),this.options.name&&(this.name=this.options.name)):alert(i),this.root=$(t),this.ieVer=this._ieVer(),this.loaderTemplate=$("<div id='"+this.NS+"-viewer-loader'><span class='l1'></span><span class='l2'></span><span class='l3'></span></div>"),this._makeLightBox(),$(window).resize(this._onResize),this._onResize()},e.prototype.setData=function(t){return this.data=t},e.prototype.show=function(t){return this._onResize(),this.ieVer>0&&this.ieVer<10?this._show_ie9(t):this._show(t)},e.prototype._useCaptionTemplate=function(){var t;return!!this.name&&(t=s.getTemplate(this.gridId,this.name,"l").getCompiled())({meta:this.meta,data:this.data[this.current_index]})},e.prototype._setAnimationName=function(){return this.count++,this.NS+"-lightbox-"+this.gridId+"-"+this.count},e.prototype._replaceForRetina=function(t){var i,e;return this.isRetina&&1!==this.pixelRatio?t.indexOf(this.retinaSuffix)>=0?t:(i=t.match(this.regexMatch),e=this.retinaSuffix+i[0],t.replace(this.regexMatch,e)):t},e.prototype._setStylesheet=function(t,i){$("<style>",{class:this.NS+"-"+i,type:"text/css"}).text(t).appendTo("head")},e.prototype._removeStylesheet=function(t){var i;i=this.NS+"-"+t,$("head>style."+i).remove()},e.prototype._setVendorPrefix=function(){"animation"in this.container.get(0).style&&(this.vendorPrefix="")},e.prototype._hide=function(){var t,i;this.isActive&&(this.isActive=!1,i=this,this.loader.remove(),this.bg.removeClass("mmg-on"),setTimeout(function(){i.container.css({visibility:"hidden",display:"none"})},400),null!=(t=this.caption)&&t.css("display","none"),this.imageBlock.empty().removeAttr("style").removeClass(this.NS+"-animate"),this.caption=null,this.image=null,this.imageBlock.off(),this._removeStylesheet("lightbox-animation"),clearTimeout(this.captionHide))},e.prototype._onResize=function(){var t,i;t=window.innerHeight||screen.height,i=window.innerWidth||screen.width,this.container.css({width:i,height:t})},e.prototype._show=function(t){var i,e,s,n,a,o,h,r,l,d,c,p,u;this.isActive=!0,r=this,h=function(t){var i;(null!=(i=r.caption)?i.get(0):void 0)&&(r.caption.appendTo($(this)).css({display:"block"}),setTimeout(function(){r.caption.addClass(r.NS+"-lb-show"),r.root.trigger("timeForCaption",r.caption.get(0))},50),r.captionHideAfter&&(r.captionHide=setTimeout(function(){r.caption.removeClass(r.NS+"-lb-show"),r.root.trigger("timeForCaptionHide",r.caption.get(0))},r.captionHideAfter))),$(this).off("oanimationend MSAnimationEnd webkitAnimationEnd animationend")},this.container.css({display:"block",visibility:"visible"}),setTimeout(function(){return r.bg.addClass("mmg-on")},50),p=window.innerHeight||screen.height,u=window.innerWidth||screen.width,a=this.data[t].href,a=this._replaceForRetina(a),this.current_index=t,this.image=this.data[t].image,l=this._useCaptionTemplate(),l&&(this.caption=$(l)),s=this.image.get(0).getBoundingClientRect(),d=s.top,o=s.left,c=s.right-o,n=s.bottom-d,e=.9*u,i=.9*p,this.loader=this.loaderTemplate.clone().css({top:n/2-8,left:c/2-40}),this.imageBlock.css({width:c,height:n,top:d,left:o}).append(this.loader),$("<img>").appendTo(this.imageBlock).one("load",function(){var t,s,a,l,m,g,f,w,v,_,b,y,x;r.loader.remove(),$(this).addClass(r.NS+"-visible"),b=this.naturalWidth,_=this.naturalHeight,w=b/_,x=u/p,g=_,f=b,w>x?b>e&&(f=e,g=f/w):_>i&&(g=i,f=g*w),g=Math.round(g),f=Math.round(f),a=(c-f)/2,l=(n-g)/2,t=(c-f)/2+u/2-(o+c/2),s=(n-g)/2+p/2-(d+n/2),v="scale3d("+c/f+", "+n/g+", 1)",t=Math.round(t),s=Math.round(s),r.imageBlock.css({width:f,height:g,"-webkit-transform":"translate3d("+a+"px,"+l+"px, 0) "+v,transform:"translate3d("+a+"px,"+l+"px, 0) "+v}),m=r._setAnimationName(),y="@"+r.vendorPrefix+"keyframes "+m+" {0% {"+r.vendorPrefix+"transform: translate3d("+a+"px,"+l+"px, 0) "+v+"} 40% {"+r.vendorPrefix+"transform: translate3d("+t+"px,"+s+"px, 0) "+v+" }100% {"+r.vendorPrefix+"transform: translate3d("+t+"px,"+s+"px, 0) scale3d(1,1,1)}}",r._setStylesheet(y,"lightbox-animation"),r.imageBlock.css(r.vendorPrefix+"animation-name",m).addClass(r.NS+"-animate").one("oanimationend MSAnimationEnd webkitAnimationEnd animationend",h),$(this).off("load")}).attr("src",a)},e.prototype._show_ie9=function(t){var i,e,s,n,a,o,h,r;a=this,this.isActive=!0,this.container.css({display:"block",visibility:"visible"}),this.bg.stop(!0).css({opacity:0}).animate({opacity:.8},1e3),h=$(window).height(),r=$(window).width(),s=this.data[t].href,s=this._replaceForRetina(s),this.current_index=t,this.image=this.data[t].image,o=this._useCaptionTemplate(),o&&(this.caption=$(o)),e=.9*r,i=.9*h,n=$("<div id='"+this.NS+"-viewer-loader'></div>"),this.loader=n.clone().css({top:h/2-50,left:r/2-50,opacity:0}).appendTo(this.container).animate({opacity:.2}),$("<img>").appendTo(this.imageBlock).one("load",function(){var t,s,n,o,l,d,c;a.loader.remove(),$(this).addClass(a.NS+"-visible"),d=$(this).naturalWidth(),l=$(this).naturalHeight(),n=d/l,c=r/h,t=l,s=d,n>c?d>e&&(s=e,t=s/n):l>i&&(t=i,s=t*n),a.imageBlock.css({width:s,height:t,left:(r-s)/2,top:(h-t)/2}).stop(!0).delay(200).animate({opacity:1},400,"swing",function(){a.caption&&(a.root.trigger("timeForCaption",a.caption.get(0)),a.captionHideAfter&&(a.captionHide=setTimeout(function(){a.root.trigger("timeForCaptionHide",a.caption.get(0))},a.captionHideAfter)))}),null!=(o=a.caption)&&o.appendTo(a.imageBlock).css({display:"block"}),$(this).off("load")}).attr("src",s)},e.prototype._makeLightBox=function(){var t,i;this.container=$("<div></div>",{class:this.NS+"-lb",id:this.NS+"-lb-"+this.gridId.substr(6)}).css({display:"none"}).appendTo("body"),this.imageBlock=$("<div></div>",{class:this.NS+"-center"}).appendTo(this.container),this.bg=$("<div></div>",{class:this.NS+"-lb-bg"}).appendTo(this.container),this.container.on("click touchend escape.mmg",function(t){return function(i){(t.isSimpleClick||void 0===$(i.target).parents("."+t.NS+"-center").get(0))&&t._hide()}}(this)),i=this,$(document).on("keydown",function(t){27===t.which&&i.container.trigger("escape.mmg")}),this._setVendorPrefix(),this.isSimpleClick||this.container.addClass(this.NS+"-noclick"),9===this.ieVer&&this.container.addClass(this.NS+"-ie9"),8===this.ieVer&&this.container.addClass(this.NS+"-ie8"),t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i,t.test(navigator.userAgent)&&this.container.addClass(this.NS+"-lb-mb")},e.prototype._ieVer=function(){var t;switch(t=0,!1){case!(document.all&&!document.querySelector):t=7;break;case!(document.all&&!document.addEventListener):t=8;break;case!(document.all&&!window.atob):t=9;break;case!document.all:t=10}return t},e.prototype.close=function(){return this._hide()},e}(),t.AJAX.Ajax=function(){function e(){}var s,n,a,o,h;return h={},n=t.Data.Models,s=t.Utility.ImageLoader,a=t.Utility.Parser,e.getAjax=function(t,i){return null==i&&(i="json"),null!=h[t]?h[t]:h[t]=new o(t,i)},o=function(){function t(t,e){this.gridId=t,this.type=e,this.getData=i(this.getData,this),this.getDeferred=i(this.getDeferred,this),this._loadHTML=i(this._loadHTML,this),this._loadJSON=i(this._loadJSON,this),this.load=i(this.load,this),this._loadPics=i(this._loadPics,this),this.data=[],this.model=n[this.gridId],this.meta=this.model.meta,this.ok=$.Deferred()}return t.prototype._loadPics=function(){var t,i;i=this,t=s.loadPics.call(this),t.then(function(){n[i.gridId].meta=i.meta,i.data=_.reject(i.data,function(t){return null==t.height}),i.ok.resolve()})},t.prototype.load=function(t,i){var e;null==i&&(i={}),null!=t&&(this.url=t),e=this.meta.root,e.height(e.height()),"json"===this.type?this._loadJSON(t,i):this._loadHTML(t,i)},t.prototype._loadJSON=function(t,i){var e;e=this,$.getJSON(t,i,function(t){var i;if(e.meta.jsonParser){if(!_.isFunction(e.meta.jsonParser))return console.error("jsonParser must be a function"),void(e.data={});i=e.meta.jsonParser(t)}else i=t;i[0].src?e.data=i:(e.data=i[0],i[1]&&(e.meta.lastLoadedMeta=i[1])),e._loadPics()})},t.prototype._loadHTML=function(t,i){var e;e=this,$.get(t,i,function(t){var i,s;i=$(document.createDocumentFragment()),i.append(t),s=a.getParser(e.gridId),e.data=s.ajax(i),e._loadPics()},"html")},t.prototype.getDeferred=function(){return this.ok=$.Deferred()},t.prototype.getData=function(){return this.data},t}(),e}(),t.Utility.NaturalSize=function(){function t(){}var i,e;return e=null,t.set=function(){return null!=e?e:e=new i},i=function(){function t(){this.setNaturalSize()}return t.prototype.setNaturalSize=function(){return function(t){var i,e,s;e=["Width","Height"],i=void 0,s=function(i,e){t.fn[i]=i in new Image?function(){return this[0][i]}:function(){var t,i,s;return i=this[0],t=void 0,s=void 0,"img"===i.tagName.toLowerCase()&&(t=new Image,t.src=i.src,s=t[e]),s}};for(;i=e.pop();)s("natural"+i,i.toLowerCase())}(jQuery)},t}(),t}(),t.Data.ModelBuilder=function(){function e(t,e){this.gridId=t,this.options=e,this._setLBTemplate=i(this._setLBTemplate,this),this._setTemplate=i(this._setTemplate,this),this._setData=i(this._setData,this),this._setMeta=i(this._setMeta,this),this._registerModel=i(this._registerModel,this),this._init=i(this._init,this),this.data=[],this.meta={},this._init()}var s,n,a;return n=t.Data.Models,a=t.Grid.def,s=t.Data.Core,e.prototype._init=function(){this._registerModel(),this._setMeta(),this._setTemplate(),this._setLBTemplate(),this._setData()},e.prototype._registerModel=function(){n[this.gridId]={data:[],meta:{},built:$.Deferred()}},e.prototype._setMeta=function(){var t,i,e,s,o;if(t=this.options,o="options parameter must be of a String or of an Object type!",this.meta.pixelRatio=window.devicePixelRatio,i=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Touch/i,i.test(navigator.userAgent)&&(this.meta.isMobile=!0,this.meta.pixelRatio>1.5?(this.meta.kVisible=2,this.meta.scrollDelta=2):(this.meta.kVisible=1,this.meta.scrollDelta=2)),null==t?alert(o):"string"==typeof t?(this.meta.grid=t,this.meta.root=$(this.meta.grid)):"object"==typeof t?(this.meta.grid=t.grid,this.meta.root=$(this.meta.grid),t.ns&&(this.meta.NS=t.ns+"-",this.meta.NSclass="."+this.meta.NS+"-",this.meta.NSevent="."+this.meta.NS),t.data&&(this.meta.data=t.data),t.templateName&&(this.meta.templateName=t.templateName),t.gridClass&&(this.meta.gridClass=t.gridClass),t.mobileGridClass&&(s=t.mobileGridClass),t.vars&&(this.meta.vars=t.vars),t.url&&(this.meta.url=t.url),t.parser&&(this.meta.parser=t.parser),t.jsonParser&&(this.meta.jsonParser=t.jsonParser),null!=t.margin&&(this.meta.margin=t.margin-0),null!=t.retina&&(this.meta.retina=t.retina),null!=t.retinaSuffix&&(this.meta.retinaSuffix=t.retinaSuffix),null!=t.height&&(this.meta.rowHeight=t.height),null!=t.timeout&&(this.meta.maxWait=t.timeout),null!=t.small&&(this.meta.maxSmall=t.small),null!=t.middle&&(this.meta.maxMiddle=t.middle),null!=t.canvasFilters&&(this.meta.filters=t.canvasFilters),null!=t.twin&&(this.meta.twin=t.twin),null!=t.svgFiltersId&&(this.meta.svgFiltersId=t.svgFiltersId,this.meta.SVGFilter=!0),null!=t.oldIEFilter&&(this.meta.oldIEFilter=t.oldIEFilter),this.meta.excludeClass="mmg-external",null!=t.excludeClass&&(this.meta.excludeClass=t.excludeClass),null!=t.excludable&&(this.meta.excludable=t.excludable),t.lightbox===!1?this.meta.lightbox=!1:"object"==typeof t.lightbox?(this.meta.lightbox=t.lightbox,this.meta.lightbox.grid=this.meta.grid):(this.meta.lightbox={},this.meta.lightbox.grid=this.meta.grid),void 0!==t.canvas&&(1===t.canvas?this.meta.useCanvas=!0:2===t.canvas&&this.meta.isMobile?this.meta.useCanvas=!0:this.meta.useCanvas=!1)):alert(o),e=this._ieVer(),this.meta.ieVer=e,this.meta.isMobile&&this.meta.useCanvas&&this.meta.retina&&(this.meta.kVisible=1),this.meta.isMobile&&this.meta.filters&&this.meta.retina&&(this.meta.kVisible=1),this.meta.isMobile&&this.meta.SVGFilter&&(this.meta.kVisible=1),this.meta.isMobile&&s&&(this.meta.gridClass=s),this.meta.supportSVGFilters=null!=window.SVGFEColorMatrixElement&&2===SVGFEColorMatrixElement.SVG_FECOLORMATRIX_TYPE_SATURATE,this.meta.supportSVGFilters||(this.meta.SVGFilter=!1),this.meta.ieFilter=!1,e>0&&e<10)switch(this.meta.SVGFilter=!1,this.meta.oldIEFilter){case"none":this.meta.useCanvas=!1,this.meta.twin=!1;break;case"canvas":9===e?this.meta.useCanvas=!0:(this.meta.ieFilter=!0,this.meta.useCanvas=!1);break;case"css":this.meta.ieFilter=!0,this.meta.useCanvas=!1;break;default:this.meta.useCanvas=!1,this.meta.twin=!1}else this.meta.SVGFilter?this.meta.useCanvas=!1:this.meta.filters?this.meta.useCanvas=!0:(this.meta.twin=!1,t.forcedTwin&&(this.meta.forcedTwin=!0));this.meta.winWidth=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,this.meta.winHeight=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,this.meta.minHeight=Infinity,_.defaults(this.meta,a),n[this.gridId].meta=this.meta,this.meta.loader={loading:0,loaded:0,end:!1,rate:0,refresh:function(){this.loading=0,this.loaded=0,this.end=!1,this.rate=0},observer:function(t,i){var e,s;s=0,this.refresh(),(e=function(n){return function(){n.loaded===s&&0!==n.loaded||(t.call(n),s=n.loaded),n.end?i.call(n):setTimeout(e,50)}}(this))()}}},e.prototype._setData=function(){new s(this.gridId)},e.prototype._setTemplate=function(){this.options.templateName?this.meta.templateName=this.options.templateName:this.meta.templateName="Simple"},e.prototype._setLBTemplate=function(){t.Lightboxes.default={},t.Lightboxes.default.template="<% var title %>\n<% if (data.lb && data.lb.title) { title = data.lb.title %>\n<% } else if (data.face && data.face.title) { title = data.face.title %>\n<% } else { title = data.title } %>\n<div class='<%=meta.NS %>-lb-caption <%=meta.NS %>-lb-default'>\n  <div class='<%=meta.NS %>-lb-title'>\n  <%= title %>\n  </div>\n  <div class='<%=meta.NS %>-lb-bg-caption'></div>\n</div>",t.Lightboxes.default.ie9={},t.Lightboxes.default.ie9.callback=function(){var t,i;i=this,t=this.model.meta,t.root.on("timeForCaption",function(i,e){return $(t.NSclass+"lb-title",e).stop(!0).delay(200).animate({opacity:1}),$(t.NSclass+"lb-bg-caption",e).stop(!0).animate({opacity:1,bottom:0})}),t.root.on("timeForCaptionHide",function(i,e){$(t.NSclass+"lb-title",e).stop(!0).animate({opacity:0}),$(t.NSclass+"lb-bg-caption",e).stop(!0).delay(200).animate({opacity:0,bottom:"-100%"})})}},e.prototype._ieVer=function(){var t;switch(t=0,!1){case!(document.all&&!document.querySelector):t=7;break;case!(document.all&&!document.addEventListener):t=8;break;case!(document.all&&!window.atob):t=9;break;case!document.all:t=10}return t},e}(),t.Lightbox.External=function(){function t(){}return t.colorBox=function(t,i){var e,s,n,a,o,h,r,l;return null==t&&(t={}),null==i&&(i={}),null==i.getTitle&&(i.getTitle=function(t){return""}),null==i.getHref&&(i.getHref=function(t){return t.href}),o=this.model,a=o.meta,r=a.root,l=a.grid,h=a.NS,n=$(),e=$("<div>",{id:"anchor-container",style:"display: none"}).appendTo("body"),s=null,r.on("dataLoaded",function(a,o){var h,r;s&&s.remove(),e.empty(),n=$(),h=o.all,h.forEach(function(t){var e;e='<a href="'+i.getHref(t)+'" rel="gal" title="'+i.getTitle(t)+'"></a>',n=n.add(e)}),e.append(n),r=$.extend({},{rel:"gal"},t),s=n.colorbox(r)}),$("body").on("click","."+h+"-link",function(t){var i;t.preventDefault(),i=$(this).parents("."+h+"-img").attr("data-image-id"),n.eq(i).click()})},t.prettyPhoto=function(t,i){var e,s,n,a,o,h,r,l,d;return null==t&&(t={}),null==i&&(i={}),null==i.getTitle&&(i.getTitle=function(t){return""}),null==i.getDescription&&(i.getDescription=function(t){return""}),null==i.getHref&&(i.getHref=function(t){return t.href}),o=this.model,a=o.meta,r=a.root,l=a.grid,h=a.NS,e=function(t,i){var e,s;return e=t.slice(0,i),s=t.slice(i),s.concat(e)},$().prettyPhoto(t),n=[],d=[],s=[],r.on("dataLoaded",function(t,e){var a;n=[],d=[],s=[],a=e.all,a.forEach(function(t){n.push(i.getHref(t)),d.push(i.getTitle(t)),s.push(i.getDescription(t))})}),$("body").on("click","."+h+"-link",function(t){var i,a,o,r;t.preventDefault(),a=$(this).parents("."+h+"-img").attr("data-image-id"),o=e(n,a),r=e(d,a),i=e(s,a),$.prettyPhoto.open(o,r,i)})},t.photoSwipe=function(t,i){var e,s,n,a,o,h,r,l,d,c,p;return null==t&&(t={}),null==i&&(i={}),i.getHight||i.getWidth||console.error("getWidth and getHeight must be specified!"),null==i.getMsrc&&(i.getMsrc=function(t){return t.src}),null==i.getHref&&(i.getHref=function(t){return t.href}),r=this.model,h=r.meta,c=h.root,p=h.grid,l=h.NS,n=function(t){var e;return e=[],_.each(t,function(t){var s;s=void 0,s={},s.src=i.getHref(t),s.msrc=i.getMsrc(t),s.title="function"==typeof i.getTitle?i.getTitle(t):void 0,s.w=i.getWidth(t),s.h=i.getHeight(t),s.d1="function"==typeof i.getD1?i.getD1(t):void 0,s.d2="function"==typeof i.getD2?i.getD2(t):void 0,s.d3="function"==typeof i.getD3?i.getD3(t):void 0,s.d4="function"==typeof i.getD4?i.getD4(t):void 0,e.push(s)}),e},d=$(".pswp")[0],d||(d=$("<div tabindex='-1' role='dialog' aria-hidden='true' class='pswp'> <div class='pswp__bg'></div> <div class='pswp__scroll-wrap'> <div class='pswp__container'> <div class='pswp__item'></div> <div class='pswp__item'></div> <div class='pswp__item'></div> </div> <div class='pswp__ui pswp__ui--hidden'> <div class='pswp__top-bar'> <div class='pswp__counter'></div> <button title='Close (Esc)' class='pswp__button pswp__button--close'></button> <button title='Share' class='pswp__button pswp__button--share'></button> <button title='Toggle fullscreen' class='pswp__button pswp__button--fs'></button> <button title='Zoom in/out' class='pswp__button pswp__button--zoom'></button> <div class='pswp__preloader'> <div class='pswp__preloader__icn'> <div class='pswp__preloader__cut'> <div class='pswp__preloader__donut'></div> </div> </div> </div> </div> <div class='pswp__share-modal pswp__share-modal--hidden pswp__single-tap'> <div class='pswp__share-tooltip'></div> </div> <button title='Previous (arrow left)' class='pswp__button pswp__button--arrow--left'></button> <button title='Next (arrow right)' class='pswp__button pswp__button--arrow--right'></button> <div class='pswp__caption'> <div class='pswp__caption__center'></div> </div> </div> </div> </div>").appendTo("body").get(0)),o=[],a=0,s=null,e={index:0},$("#container").on("dataLoaded",function(t,i){var e;e=void 0,e=i.all.length,o=n(i.all),a=e}),$("#container").on("click","."+l+"-link",function(i){var n,h;i.preventDefault(),n=$(this).parents("."+l+"-img"),a=1*n.attr("data-image-id"),e={index:a,showAnimationDuration:500,hideAnimationDuration:500,showHideOpacity:!0,getThumbBoundsFn:function(t){var i,e,s;return s=n.find("."+l+"-icon").get(0),i=window.pageYOffset||document.documentElement.scrollTop,e=s.getBoundingClientRect(),{x:e.left,y:e.top+i,w:e.width}}},h=$.extend({},e,t),s=null,s=new PhotoSwipe(d,PhotoSwipeUI_Default,o,h),s.init()})},t}(),t.Grid.Grid=function(){function e(t){this.options=t,this.getLastLoadedMeta=i(this.getLastLoadedMeta,this),this.getExternalLightbox=i(this.getExternalLightbox,this),this._makeGrid=i(this._makeGrid,this),this._setLightbox=i(this._setLightbox,this),this._resetView=i(this._resetView,this),this.loadByAjax=i(this.loadByAjax,this),this._setModel=i(this._setModel,this),this._init=i(this._init,this),this.gridId=_.uniqueId("model_"),this.model={},this.ajax=null,this.view=null,this._init()}var s,n,a,o,h,r,l,d;return n=t.Data.ModelBuilder,h=t.Data.Models,r=t.Utility.NaturalSize,d=t.View.View,s=t.AJAX.Ajax,a=t.Lightbox.Lightbox,o=t.Lightbox.LightboxSwipe,l=t.View.Template,e.prototype._init=function(){this._setArrayIndexOf(),r.set(),this._setModel(),this._setLightbox()},e.prototype._setModel=function(){var t;new n(this.gridId,this.options),this.model=h[this.gridId],t=this,this.model.built.then(function(){t._makeGrid()})},e.prototype._makeView=function(){this.view=new d(this.gridId)},e.prototype.loadByAjax=function(t,i,e){var n;this.ajax=s.getAjax(this.gridId,e),n=this.ajax.getDeferred(),this.ajax.load(t,i),n.then(this._resetView)},e.prototype._resetView=function(){var t;t=this.ajax.getData(),this.view.add(t)},e.prototype._setLightbox=function(){this.model.meta.lightbox&&(this.model.meta.lightbox.swipe?this.lb=new o(this.gridId,this.model.meta):this.lb=new a(this.gridId,this.model.meta),this.lb.open=_.wrap(this.lb.show,function(t){return function(i,e){var s,n;return t.model.meta.excludable?(s=_.reject(t.model.data,function(t){return t.excluded}),n=_.map(s,function(t){var i;return null!=(i=t.image)?i.attr("data-image-id"):void 0}).indexOf(e)):(s=t.model.data,n=e),t.lb.setData(s),i(n)}}(this)),this.model.meta.root.on("click",this.model.meta.NSclass+"link",function(t){return function(i){var e,s;e=$(i.target).hasClass(t.model.meta.NS+"-img")?$(i.target):$(i.target).parents("."+t.model.meta.NS+"-img"),t.model.meta.excludable&&e.hasClass(t.model.meta.excludeClass)||(i.preventDefault(),s=e.attr("data-image-id"),t.lb.open(s))}}(this)))},e.prototype._makeGrid=function(){var t,i,e,s;i=this.model.meta,e=i.root,e.wrap("<div class='"+i.NS+"-grid-wrapper'></div>"),e.width(e.width()).addClass(i.NS+"-grid"),s=e.parent(),s.css({width:"100%",overflow:"hidden"}),t=i.gridClass,t&&e.addClass(t),i.twin&&e.addClass(i.NS+"-twin"),i.isMobile&&e.addClass(i.NS+"-mb"),9===i.ieVer&&e.addClass(i.NS+"-ie9"),8===i.ieVer&&e.addClass(i.NS+"-ie8"),this._makeView()},e.prototype.getExternalLightbox=function(i,e,s){switch(i){case"colorbox":return t.Lightbox.External.colorBox.call(this,e,s);case"prettyphoto":return t.Lightbox.External.prettyPhoto.call(this,e,s);case"photoswipe":return t.Lightbox.External.photoSwipe.call(this,e,s);default:return console.error("Wrong lightbox parameter!")}},e.prototype.getLastLoadedMeta=function(){var t;return null!=(t=this.model.meta)?t.lastLoadedMeta:void 0},e.prototype.getLightbox=function(){return this.lb},e.prototype.getLoader=function(){return this.model.meta.loader},e.prototype._setArrayIndexOf=function(){if(!Array.prototype.indexOf)return Array.prototype.indexOf=function(t,i){var e,s,n,a;if(s=void 0,null===this)throw new TypeError('"this" is null or not defined');if(e=Object(this),n=e.length>>>0,0===n)return-1;if(a=+i||0,Infinity===Math.abs(a)&&(a=0),a>=n)return-1;for(s=Math.max(a>=0?a:n-Math.abs(a),0);s<n;){if(s in e&&e[s]===t)return s;s++}return-1}},e}(),t.Gallery=function(i,e,s){var n,a,o;return null==s&&(s=!0),n=t.Templates[i].defaults,null==n&&(n={}),null==e&&(e={}),o=$.extend({},n,e),"grayscale"===o.svgFiltersId&&s&&(a='<svg width="0" height="0"><defs><filter id="grayscale"><fecolormatrix type="saturate" values="0"></fecolormatrix></filter></defs></svg>',$(a).appendTo("body")),new t.Grid.Grid(o)},t=window.MMG,t.Templates.Simple={},t.Templates.Simple.template="<div class='<%=meta.NS %>-img <%= data.classList %>' data-image-id='<%= imageId %>'> <% if(data.href) { %> <a href='<%= data.href %>' class='<%=meta.NS %>-link' rel='gal'> <% } %> <% if(data.face) { %> <div class='<%=meta.NS %>-f-caption'> <% if(data.face&&data.face.descr) { %> <div class='<%=meta.NS %>-descr'> <span class='<%=meta.NS %>-caption-bg'> <%= data.face.descr %> </span> </div> <% } %> <% if(data.face&&data.face.title) { %> <h3 class='<%=meta.NS %>-title'> <span class='<%=meta.NS %>-title-bg'> <%= data.face.title %> </span> </h3> <% } %> <% if(data.face&&data.face.secondDescr) { %> <div class='<%=meta.NS %>-footer'> <span class='<%=meta.NS %>-caption-bg'> <%= data.face.secondDescr %> </span> </div> <% } %> </div> <% } %> <img class='<%=meta.NS %>-icon <%=meta.NS %>-fs' src='<%= data.src %>'> <% if(data.href) { %> </a> <% } %> </div>",t.Templates.Simple.defaults={templateName:"Simple"}}).call(this);